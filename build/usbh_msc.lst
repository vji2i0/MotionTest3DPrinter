ARM GAS  /tmp/cceJiy7O.s 			page 1


   1              		.cpu cortex-m3
   2              		.eabi_attribute 20, 1
   3              		.eabi_attribute 21, 1
   4              		.eabi_attribute 23, 3
   5              		.eabi_attribute 24, 1
   6              		.eabi_attribute 25, 1
   7              		.eabi_attribute 26, 1
   8              		.eabi_attribute 30, 1
   9              		.eabi_attribute 34, 1
  10              		.eabi_attribute 18, 4
  11              		.file	"usbh_msc.c"
  12              		.text
  13              	.Ltext0:
  14              		.cfi_sections	.debug_frame
  15              		.section	.text.USBH_MSC_SOFProcess,"ax",%progbits
  16              		.align	1
  17              		.syntax unified
  18              		.thumb
  19              		.thumb_func
  20              		.fpu softvfp
  22              	USBH_MSC_SOFProcess:
  23              	.LFB70:
  24              		.file 1 "Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c"
   1:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** /**
   2:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   ******************************************************************************
   3:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @file    usbh_msc.c
   4:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @author  MCD Application Team
   5:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @version V3.2.2
   6:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @date    07-July-2015
   7:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @brief   This file implements the MSC class driver functions
   8:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   *          ===================================================================      
   9:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   *                                MSC Class  Description
  10:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   *          =================================================================== 
  11:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   *           This module manages the MSC class V1.0 following the "Universal 
  12:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   *           Serial Bus Mass Storage Class (MSC) Bulk-Only Transport (BOT) Version 1.0
  13:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   *           Sep. 31, 1999".
  14:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   *           This driver implements the following aspects of the specification:
  15:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   *             - Bulk-Only Transport protocol
  16:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   *             - Subclass : SCSI transparent command set (ref. SCSI Primary Commands - 3 (SPC-3))
  17:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   *      
  18:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   *  @endverbatim
  19:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   *
  20:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   ******************************************************************************
  21:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @attention
  22:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   *
  23:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * <h2><center>&copy; COPYRIGHT 2015 STMicroelectronics</center></h2>
  24:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   *
  25:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * Licensed under MCD-ST Liberty SW License Agreement V2, (the "License");
  26:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * You may not use this file except in compliance with the License.
  27:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * You may obtain a copy of the License at:
  28:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   *
  29:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   *        http://www.st.com/software_license_agreement_liberty_v2
  30:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   *
  31:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * Unless required by applicable law or agreed to in writing, software 
  32:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * distributed under the License is distributed on an "AS IS" BASIS, 
  33:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  34:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * See the License for the specific language governing permissions and
ARM GAS  /tmp/cceJiy7O.s 			page 2


  35:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * limitations under the License.
  36:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   *
  37:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   ******************************************************************************
  38:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   */
  39:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** 
  40:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** /* Includes ------------------------------------------------------------------*/
  41:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** 
  42:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** #include "usbh_msc.h"
  43:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** #include "usbh_msc_bot.h"    
  44:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** #include "usbh_msc_scsi.h"
  45:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** 
  46:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** 
  47:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** /** @addtogroup USBH_LIB
  48:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @{
  49:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   */
  50:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** 
  51:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** /** @addtogroup USBH_CLASS
  52:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @{
  53:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   */
  54:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** 
  55:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** /** @addtogroup USBH_MSC_CLASS
  56:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @{
  57:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   */
  58:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   
  59:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** /** @defgroup USBH_MSC_CORE 
  60:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @brief    This file includes the mass storage related functions
  61:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @{
  62:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   */ 
  63:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** 
  64:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** 
  65:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** /** @defgroup USBH_MSC_CORE_Private_TypesDefinitions
  66:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @{
  67:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   */ 
  68:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** /**
  69:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @}
  70:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   */ 
  71:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** 
  72:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** /** @defgroup USBH_MSC_CORE_Private_Defines
  73:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @{
  74:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   */ 
  75:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** /**
  76:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @}
  77:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   */ 
  78:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** 
  79:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** /** @defgroup USBH_MSC_CORE_Private_Macros
  80:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @{
  81:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   */ 
  82:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** /**
  83:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @}
  84:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   */ 
  85:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** 
  86:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** 
  87:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** /** @defgroup USBH_MSC_CORE_Private_Variables
  88:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @{
  89:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   */ 
  90:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** /**
  91:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @}
ARM GAS  /tmp/cceJiy7O.s 			page 3


  92:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   */ 
  93:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** 
  94:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** 
  95:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** /** @defgroup USBH_MSC_CORE_Private_FunctionPrototypes
  96:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @{
  97:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   */ 
  98:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** 
  99:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** static USBH_StatusTypeDef USBH_MSC_InterfaceInit  (USBH_HandleTypeDef *phost);
 100:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** 
 101:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** static USBH_StatusTypeDef USBH_MSC_InterfaceDeInit  (USBH_HandleTypeDef *phost);
 102:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** 
 103:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** static USBH_StatusTypeDef USBH_MSC_Process(USBH_HandleTypeDef *phost);
 104:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** 
 105:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** static USBH_StatusTypeDef USBH_MSC_ClassRequest(USBH_HandleTypeDef *phost);
 106:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** 
 107:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** static USBH_StatusTypeDef USBH_MSC_SOFProcess(USBH_HandleTypeDef *phost);
 108:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** 
 109:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** static USBH_StatusTypeDef USBH_MSC_RdWrProcess(USBH_HandleTypeDef *phost, uint8_t lun);
 110:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** 
 111:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** USBH_ClassTypeDef  USBH_msc = 
 112:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** {
 113:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   "MSC",
 114:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   USB_MSC_CLASS,
 115:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   USBH_MSC_InterfaceInit,
 116:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   USBH_MSC_InterfaceDeInit,
 117:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   USBH_MSC_ClassRequest,
 118:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   USBH_MSC_Process,
 119:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   USBH_MSC_SOFProcess,
 120:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   NULL,
 121:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** };
 122:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** 
 123:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** 
 124:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** /**
 125:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @}
 126:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   */ 
 127:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** 
 128:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** 
 129:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** /** @defgroup USBH_MSC_CORE_Exported_Variables
 130:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @{
 131:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   */ 
 132:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** 
 133:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** /**
 134:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @}
 135:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   */ 
 136:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** 
 137:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** 
 138:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** /** @defgroup USBH_MSC_CORE_Private_Functions
 139:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @{
 140:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   */ 
 141:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** 
 142:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** 
 143:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** /**
 144:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @brief  USBH_MSC_InterfaceInit 
 145:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   *         The function init the MSC class.
 146:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @param  phost: Host handle
 147:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @retval USBH Status
 148:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   */
ARM GAS  /tmp/cceJiy7O.s 			page 4


 149:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** static USBH_StatusTypeDef USBH_MSC_InterfaceInit (USBH_HandleTypeDef *phost)
 150:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** {	 
 151:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   uint8_t interface = 0; 
 152:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   USBH_StatusTypeDef status = USBH_FAIL ;
 153:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   MSC_HandleTypeDef *MSC_Handle;
 154:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   
 155:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   interface = USBH_FindInterface(phost, phost->pActiveClass->ClassCode, MSC_TRANSPARENT, MSC_BOT);
 156:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   
 157:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   if(interface == 0xFF) /* Not Valid Interface */
 158:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   {
 159:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     USBH_DbgLog ("Cannot Find the interface for %s class.", phost->pActiveClass->Name);
 160:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     status = USBH_FAIL;      
 161:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   }
 162:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   else
 163:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   {
 164:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     USBH_SelectInterface (phost, interface);
 165:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     
 166:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     phost->pActiveClass->pData = (MSC_HandleTypeDef *)USBH_malloc (sizeof(MSC_HandleTypeDef));
 167:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     MSC_Handle =  (MSC_HandleTypeDef *) phost->pActiveClass->pData;
 168:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     
 169:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     if(phost->device.CfgDesc.Itf_Desc[phost->device.current_interface].Ep_Desc[0].bEndpointAddress 
 170:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     {
 171:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       MSC_Handle->InEp = (phost->device.CfgDesc.Itf_Desc[phost->device.current_interface].Ep_Desc[0
 172:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       MSC_Handle->InEpSize  = phost->device.CfgDesc.Itf_Desc[phost->device.current_interface].Ep_De
 173:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     }
 174:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     else
 175:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     {
 176:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       MSC_Handle->OutEp = (phost->device.CfgDesc.Itf_Desc[phost->device.current_interface].Ep_Desc[
 177:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       MSC_Handle->OutEpSize  = phost->device.CfgDesc.Itf_Desc[phost->device.current_interface].Ep_D
 178:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     }
 179:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     
 180:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     if(phost->device.CfgDesc.Itf_Desc[phost->device.current_interface].Ep_Desc[1].bEndpointAddress 
 181:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     {
 182:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       MSC_Handle->InEp = (phost->device.CfgDesc.Itf_Desc[phost->device.current_interface].Ep_Desc[1
 183:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       MSC_Handle->InEpSize  = phost->device.CfgDesc.Itf_Desc[phost->device.current_interface].Ep_De
 184:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     }
 185:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     else
 186:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     {
 187:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       MSC_Handle->OutEp = (phost->device.CfgDesc.Itf_Desc[phost->device.current_interface].Ep_Desc[
 188:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       MSC_Handle->OutEpSize  = phost->device.CfgDesc.Itf_Desc[phost->device.current_interface].Ep_D
 189:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     }
 190:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     
 191:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     MSC_Handle->current_lun = 0;
 192:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     MSC_Handle->rw_lun = 0;
 193:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     MSC_Handle->state = MSC_INIT;
 194:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     MSC_Handle->error = MSC_OK;
 195:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     MSC_Handle->req_state = MSC_REQ_IDLE;
 196:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     MSC_Handle->OutPipe = USBH_AllocPipe(phost, MSC_Handle->OutEp);
 197:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     MSC_Handle->InPipe = USBH_AllocPipe(phost, MSC_Handle->InEp);
 198:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** 
 199:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     USBH_MSC_BOT_Init(phost);
 200:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     
 201:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     /* De-Initialize LUNs information */
 202:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     USBH_memset(MSC_Handle->unit, 0, sizeof(MSC_Handle->unit));
 203:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     
 204:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     /* Open the new channels */
 205:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     USBH_OpenPipe  (phost,
ARM GAS  /tmp/cceJiy7O.s 			page 5


 206:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****                     MSC_Handle->OutPipe,
 207:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****                     MSC_Handle->OutEp,
 208:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****                     phost->device.address,
 209:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****                     phost->device.speed,
 210:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****                     USB_EP_TYPE_BULK,
 211:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****                     MSC_Handle->OutEpSize);  
 212:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     
 213:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     USBH_OpenPipe  (phost,
 214:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****                     MSC_Handle->InPipe,
 215:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****                     MSC_Handle->InEp,
 216:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****                     phost->device.address,
 217:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****                     phost->device.speed,
 218:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****                     USB_EP_TYPE_BULK,
 219:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****                     MSC_Handle->InEpSize);     
 220:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     
 221:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     
 222:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     USBH_LL_SetToggle  (phost, MSC_Handle->InPipe,0);
 223:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     USBH_LL_SetToggle  (phost, MSC_Handle->OutPipe,0);
 224:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     status = USBH_OK; 
 225:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   }
 226:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   return status;
 227:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** }
 228:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** 
 229:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** /**
 230:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @brief  USBH_MSC_InterfaceDeInit 
 231:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   *         The function DeInit the Pipes used for the MSC class.
 232:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @param  phost: Host handle
 233:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @retval USBH Status
 234:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   */
 235:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** USBH_StatusTypeDef USBH_MSC_InterfaceDeInit (USBH_HandleTypeDef *phost)
 236:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** {
 237:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   MSC_HandleTypeDef *MSC_Handle =  (MSC_HandleTypeDef *) phost->pActiveClass->pData;
 238:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** 
 239:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   if ( MSC_Handle->OutPipe)
 240:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   {
 241:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     USBH_ClosePipe(phost, MSC_Handle->OutPipe);
 242:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     USBH_FreePipe  (phost, MSC_Handle->OutPipe);
 243:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     MSC_Handle->OutPipe = 0;     /* Reset the Channel as Free */
 244:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   }
 245:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   
 246:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   if ( MSC_Handle->InPipe)
 247:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   {
 248:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     USBH_ClosePipe(phost, MSC_Handle->InPipe);
 249:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     USBH_FreePipe  (phost, MSC_Handle->InPipe);
 250:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     MSC_Handle->InPipe = 0;     /* Reset the Channel as Free */
 251:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   } 
 252:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** 
 253:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   if(phost->pActiveClass->pData)
 254:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   {
 255:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     USBH_free (phost->pActiveClass->pData);
 256:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     phost->pActiveClass->pData = 0;
 257:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   }
 258:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   
 259:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   return USBH_OK;
 260:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** }
 261:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** 
 262:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** /**
ARM GAS  /tmp/cceJiy7O.s 			page 6


 263:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @brief  USBH_MSC_ClassRequest 
 264:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   *         The function is responsible for handling Standard requests
 265:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   *         for MSC class.
 266:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @param  phost: Host handle
 267:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @retval USBH Status
 268:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   */
 269:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** static USBH_StatusTypeDef USBH_MSC_ClassRequest(USBH_HandleTypeDef *phost)
 270:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** {   
 271:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   MSC_HandleTypeDef *MSC_Handle =  (MSC_HandleTypeDef *) phost->pActiveClass->pData;  
 272:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   USBH_StatusTypeDef status = USBH_BUSY;
 273:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   uint8_t i;
 274:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   
 275:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   /* Switch MSC REQ state machine */
 276:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   switch (MSC_Handle->req_state)
 277:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   {
 278:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   case MSC_REQ_IDLE:
 279:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   case MSC_REQ_GET_MAX_LUN:   
 280:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     /* Issue GetMaxLUN request */
 281:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     status = USBH_MSC_BOT_REQ_GetMaxLUN(phost, (uint8_t *)&MSC_Handle->max_lun);
 282:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     
 283:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     /* When devices do not support the GetMaxLun request, this should
 284:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****        be considred as only one logical unit is supported */
 285:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     if(status == USBH_NOT_SUPPORTED)
 286:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     {
 287:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       MSC_Handle->max_lun = 0;
 288:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       status = USBH_OK;
 289:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     }
 290:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     
 291:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     if(status == USBH_OK)
 292:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     {
 293:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       MSC_Handle->max_lun = (uint8_t )(MSC_Handle->max_lun) + 1;
 294:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       USBH_UsrLog ("Number of supported LUN: %lu", (int32_t)(MSC_Handle->max_lun));
 295:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       
 296:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       for(i = 0; i < MSC_Handle->max_lun; i++)
 297:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       {
 298:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         MSC_Handle->unit[i].prev_ready_state = USBH_FAIL;
 299:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         MSC_Handle->unit[i].state_changed = 0;
 300:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       }
 301:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     }
 302:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     break;
 303:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     
 304:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   case MSC_REQ_ERROR :
 305:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     /* a Clear Feature should be issued here */
 306:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     if(USBH_ClrFeature(phost, 0x00) == USBH_OK)
 307:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     {
 308:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       MSC_Handle->req_state = MSC_Handle->prev_req_state; 
 309:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     }    
 310:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     break;
 311:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     
 312:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   default:
 313:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     break;
 314:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   }
 315:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   
 316:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   return status; 
 317:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** }
 318:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** 
 319:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** /**
ARM GAS  /tmp/cceJiy7O.s 			page 7


 320:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @brief  USBH_MSC_Process 
 321:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   *         The function is for managing state machine for MSC data transfers 
 322:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @param  phost: Host handle
 323:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @retval USBH Status
 324:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   */
 325:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** static USBH_StatusTypeDef USBH_MSC_Process(USBH_HandleTypeDef *phost)
 326:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** {
 327:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   MSC_HandleTypeDef *MSC_Handle =  (MSC_HandleTypeDef *) phost->pActiveClass->pData;
 328:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   USBH_StatusTypeDef error = USBH_BUSY ;
 329:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   USBH_StatusTypeDef scsi_status = USBH_BUSY ;  
 330:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   USBH_StatusTypeDef ready_status = USBH_BUSY ;
 331:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   
 332:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   switch (MSC_Handle->state)
 333:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   {
 334:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   case MSC_INIT:
 335:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     
 336:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     if(MSC_Handle->current_lun < MSC_Handle->max_lun)
 337:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     {
 338:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** 
 339:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       MSC_Handle->unit[MSC_Handle->current_lun].error = MSC_NOT_READY;
 340:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       /* Switch MSC REQ state machine */
 341:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       switch (MSC_Handle->unit[MSC_Handle->current_lun].state)
 342:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       {
 343:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       case MSC_INIT:
 344:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         USBH_UsrLog ("LUN #%d: ", MSC_Handle->current_lun);
 345:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         MSC_Handle->unit[MSC_Handle->current_lun].state = MSC_READ_INQUIRY;
 346:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         MSC_Handle->timer = phost->Timer;
 347:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         
 348:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       case MSC_READ_INQUIRY:
 349:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         scsi_status = USBH_MSC_SCSI_Inquiry(phost, MSC_Handle->current_lun, &MSC_Handle->unit[MSC_H
 350:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         
 351:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         if( scsi_status == USBH_OK)
 352:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         {
 353:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           USBH_UsrLog ("Inquiry Vendor  : %s", MSC_Handle->unit[MSC_Handle->current_lun].inquiry.ve
 354:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           USBH_UsrLog ("Inquiry Product : %s", MSC_Handle->unit[MSC_Handle->current_lun].inquiry.pr
 355:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           USBH_UsrLog ("Inquiry Version : %s", MSC_Handle->unit[MSC_Handle->current_lun].inquiry.re
 356:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           MSC_Handle->unit[MSC_Handle->current_lun].state = MSC_TEST_UNIT_READY;        
 357:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         }
 358:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         if( scsi_status == USBH_FAIL)
 359:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         {
 360:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           MSC_Handle->unit[MSC_Handle->current_lun].state = MSC_REQUEST_SENSE;         
 361:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         }
 362:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         else if(scsi_status == USBH_UNRECOVERED_ERROR)
 363:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         {
 364:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           MSC_Handle->unit[MSC_Handle->current_lun].state = MSC_IDLE;
 365:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           MSC_Handle->unit[MSC_Handle->current_lun].error = MSC_ERROR;
 366:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         }
 367:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         break;    
 368:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         
 369:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       case MSC_TEST_UNIT_READY:
 370:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         ready_status = USBH_MSC_SCSI_TestUnitReady(phost, MSC_Handle->current_lun);
 371:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         
 372:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         if( ready_status == USBH_OK)
 373:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         {
 374:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           if( MSC_Handle->unit[MSC_Handle->current_lun].prev_ready_state != USBH_OK)
 375:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           {
 376:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****             MSC_Handle->unit[MSC_Handle->current_lun].state_changed = 1;
ARM GAS  /tmp/cceJiy7O.s 			page 8


 377:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****             USBH_UsrLog ("MSC Device ready");
 378:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           }
 379:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           else
 380:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           {
 381:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****             MSC_Handle->unit[MSC_Handle->current_lun].state_changed = 0;
 382:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           }
 383:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           MSC_Handle->unit[MSC_Handle->current_lun].state = MSC_READ_CAPACITY10;
 384:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           MSC_Handle->unit[MSC_Handle->current_lun].error = MSC_OK;
 385:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           MSC_Handle->unit[MSC_Handle->current_lun].prev_ready_state = USBH_OK;
 386:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         }
 387:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         if( ready_status == USBH_FAIL)
 388:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         {
 389:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           /* Media not ready, so try to check again during 10s */
 390:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           if( MSC_Handle->unit[MSC_Handle->current_lun].prev_ready_state != USBH_FAIL)
 391:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           {
 392:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****             MSC_Handle->unit[MSC_Handle->current_lun].state_changed = 1;
 393:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****             USBH_UsrLog ("MSC Device NOT ready");
 394:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           }
 395:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           else
 396:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           {
 397:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****             MSC_Handle->unit[MSC_Handle->current_lun].state_changed = 0;
 398:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           }         
 399:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****             MSC_Handle->unit[MSC_Handle->current_lun].state = MSC_REQUEST_SENSE; 
 400:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****             MSC_Handle->unit[MSC_Handle->current_lun].error = MSC_NOT_READY;
 401:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****             MSC_Handle->unit[MSC_Handle->current_lun].prev_ready_state = USBH_FAIL;
 402:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         }
 403:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         else if(ready_status == USBH_UNRECOVERED_ERROR)
 404:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         {
 405:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           MSC_Handle->unit[MSC_Handle->current_lun].state = MSC_IDLE;
 406:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           MSC_Handle->unit[MSC_Handle->current_lun].error = MSC_ERROR;
 407:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         }
 408:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         break;
 409:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         
 410:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       case MSC_READ_CAPACITY10:   
 411:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         scsi_status = USBH_MSC_SCSI_ReadCapacity(phost,MSC_Handle->current_lun, &MSC_Handle->unit[M
 412:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         
 413:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         if(scsi_status == USBH_OK)
 414:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         {
 415:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           if(MSC_Handle->unit[MSC_Handle->current_lun].state_changed == 1)
 416:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           {
 417:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****             USBH_UsrLog ("MSC Device capacity : %lu Bytes", \
 418:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****               (int32_t)(MSC_Handle->unit[MSC_Handle->current_lun].capacity.block_nbr * MSC_Handle->
 419:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****             USBH_UsrLog ("Block number : %lu", (int32_t)(MSC_Handle->unit[MSC_Handle->current_lun].
 420:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****             USBH_UsrLog ("Block Size   : %lu", (int32_t)(MSC_Handle->unit[MSC_Handle->current_lun].
 421:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           }
 422:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           MSC_Handle->unit[MSC_Handle->current_lun].state = MSC_IDLE;
 423:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           MSC_Handle->unit[MSC_Handle->current_lun].error = MSC_OK;
 424:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           MSC_Handle->current_lun++;
 425:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         }
 426:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         else if( scsi_status == USBH_FAIL)
 427:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         {
 428:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           MSC_Handle->unit[MSC_Handle->current_lun].state = MSC_REQUEST_SENSE;
 429:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         }
 430:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         else if(scsi_status == USBH_UNRECOVERED_ERROR)
 431:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         {
 432:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           MSC_Handle->unit[MSC_Handle->current_lun].state = MSC_IDLE;
 433:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           MSC_Handle->unit[MSC_Handle->current_lun].error = MSC_ERROR;
ARM GAS  /tmp/cceJiy7O.s 			page 9


 434:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         }
 435:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         break;
 436:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         
 437:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       case MSC_REQUEST_SENSE:
 438:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         scsi_status = USBH_MSC_SCSI_RequestSense(phost,  MSC_Handle->current_lun, &MSC_Handle->unit
 439:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         
 440:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         if( scsi_status == USBH_OK)
 441:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         {
 442:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           if((MSC_Handle->unit[MSC_Handle->current_lun].sense.key == SCSI_SENSE_KEY_UNIT_ATTENTION)
 443:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****              (MSC_Handle->unit[MSC_Handle->current_lun].sense.key == SCSI_SENSE_KEY_NOT_READY) )   
 444:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           {
 445:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****             
 446:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****             if((phost->Timer - MSC_Handle->timer) < 10000)
 447:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****             {
 448:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****               MSC_Handle->unit[MSC_Handle->current_lun].state = MSC_TEST_UNIT_READY;
 449:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****               break;
 450:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****             }        
 451:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           }
 452:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           
 453:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           USBH_UsrLog ("Sense Key  : %x", MSC_Handle->unit[MSC_Handle->current_lun].sense.key);
 454:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           USBH_UsrLog ("Additional Sense Code : %x", MSC_Handle->unit[MSC_Handle->current_lun].sens
 455:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           USBH_UsrLog ("Additional Sense Code Qualifier: %x", MSC_Handle->unit[MSC_Handle->current_
 456:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           MSC_Handle->unit[MSC_Handle->current_lun].state = MSC_IDLE;
 457:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           MSC_Handle->current_lun++;
 458:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         }
 459:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         if( scsi_status == USBH_FAIL)
 460:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         {
 461:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           USBH_UsrLog ("MSC Device NOT ready");
 462:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           MSC_Handle->unit[MSC_Handle->current_lun].state = MSC_UNRECOVERED_ERROR; 
 463:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         }
 464:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         else if(scsi_status == USBH_UNRECOVERED_ERROR)
 465:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         {
 466:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           MSC_Handle->unit[MSC_Handle->current_lun].state = MSC_IDLE;
 467:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           MSC_Handle->unit[MSC_Handle->current_lun].error = MSC_ERROR;   
 468:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         }
 469:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         break;  
 470:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     
 471:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       case MSC_UNRECOVERED_ERROR: 
 472:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         MSC_Handle->current_lun++;
 473:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         break;  
 474:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         
 475:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       default:
 476:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         break;
 477:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       }
 478:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       
 479:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** #if (USBH_USE_OS == 1)
 480:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     osMessagePut ( phost->os_event, USBH_CLASS_EVENT, 0);
 481:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** #endif       
 482:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     }
 483:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     else
 484:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     {
 485:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       MSC_Handle->current_lun = 0;
 486:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     MSC_Handle->state = MSC_IDLE;
 487:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** #if (USBH_USE_OS == 1)
 488:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     osMessagePut ( phost->os_event, USBH_CLASS_EVENT, 0);
 489:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** #endif 
 490:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     phost->pUser(phost, HOST_USER_CLASS_ACTIVE);     
ARM GAS  /tmp/cceJiy7O.s 			page 10


 491:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     }
 492:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     break;
 493:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** 
 494:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   case MSC_IDLE:
 495:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     error = USBH_OK;  
 496:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     break;
 497:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     
 498:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   default:
 499:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     break; 
 500:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   }
 501:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   return error;
 502:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** }
 503:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** 
 504:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** 
 505:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** /**
 506:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @brief  USBH_MSC_SOFProcess 
 507:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   *         The function is for SOF state
 508:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @param  phost: Host handle
 509:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @retval USBH Status
 510:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   */
 511:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** static USBH_StatusTypeDef USBH_MSC_SOFProcess(USBH_HandleTypeDef *phost)
 512:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** {
  25              		.loc 1 512 0
  26              		.cfi_startproc
  27              		@ args = 0, pretend = 0, frame = 0
  28              		@ frame_needed = 0, uses_anonymous_args = 0
  29              		@ link register save eliminated.
  30              	.LVL0:
 513:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** 
 514:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   return USBH_OK;
 515:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** }
  31              		.loc 1 515 0
  32 0000 0020     		movs	r0, #0
  33              	.LVL1:
  34 0002 7047     		bx	lr
  35              		.cfi_endproc
  36              	.LFE70:
  38              		.section	.text.USBH_MSC_Process,"ax",%progbits
  39              		.align	1
  40              		.syntax unified
  41              		.thumb
  42              		.thumb_func
  43              		.fpu softvfp
  45              	USBH_MSC_Process:
  46              	.LFB69:
 326:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   MSC_HandleTypeDef *MSC_Handle =  (MSC_HandleTypeDef *) phost->pActiveClass->pData;
  47              		.loc 1 326 0
  48              		.cfi_startproc
  49              		@ args = 0, pretend = 0, frame = 0
  50              		@ frame_needed = 0, uses_anonymous_args = 0
  51              	.LVL2:
  52 0000 70B5     		push	{r4, r5, r6, lr}
  53              	.LCFI0:
  54              		.cfi_def_cfa_offset 16
  55              		.cfi_offset 4, -16
  56              		.cfi_offset 5, -12
  57              		.cfi_offset 6, -8
ARM GAS  /tmp/cceJiy7O.s 			page 11


  58              		.cfi_offset 14, -4
 327:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   USBH_StatusTypeDef error = USBH_BUSY ;
  59              		.loc 1 327 0
  60 0002 D0F87433 		ldr	r3, [r0, #884]
  61 0006 DC69     		ldr	r4, [r3, #28]
  62              	.LVL3:
 332:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   {
  63              		.loc 1 332 0
  64 0008 237B     		ldrb	r3, [r4, #12]	@ zero_extendqisi2
  65 000a 23B1     		cbz	r3, .L4
  66 000c 012B     		cmp	r3, #1
  67 000e 00F04381 		beq	.L28
 328:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   USBH_StatusTypeDef scsi_status = USBH_BUSY ;  
  68              		.loc 1 328 0
  69 0012 0120     		movs	r0, #1
  70              	.LVL4:
  71              	.L5:
 502:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** 
  72              		.loc 1 502 0
  73 0014 70BD     		pop	{r4, r5, r6, pc}
  74              	.LVL5:
  75              	.L4:
  76 0016 0646     		mov	r6, r0
 336:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     {
  77              		.loc 1 336 0
  78 0018 B4F8F810 		ldrh	r1, [r4, #248]
  79 001c 2368     		ldr	r3, [r4]
  80 001e 9942     		cmp	r1, r3
  81 0020 0AD3     		bcc	.L35
 485:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     MSC_Handle->state = MSC_IDLE;
  82              		.loc 1 485 0
  83 0022 0023     		movs	r3, #0
  84 0024 A4F8F830 		strh	r3, [r4, #248]	@ movhi
 486:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** #if (USBH_USE_OS == 1)
  85              		.loc 1 486 0
  86 0028 0125     		movs	r5, #1
  87 002a 2573     		strb	r5, [r4, #12]
 490:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     }
  88              		.loc 1 490 0
  89 002c D0F8C433 		ldr	r3, [r0, #964]
  90 0030 0221     		movs	r1, #2
  91 0032 9847     		blx	r3
  92              	.LVL6:
 328:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   USBH_StatusTypeDef scsi_status = USBH_BUSY ;  
  93              		.loc 1 328 0
  94 0034 2846     		mov	r0, r5
  95 0036 EDE7     		b	.L5
  96              	.LVL7:
  97              	.L35:
 339:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       /* Switch MSC REQ state machine */
  98              		.loc 1 339 0
  99 0038 3423     		movs	r3, #52
 100 003a 03FB0143 		mla	r3, r3, r1, r4
 101 003e 0122     		movs	r2, #1
 102 0040 83F89120 		strb	r2, [r3, #145]
 341:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       {
 103              		.loc 1 341 0
ARM GAS  /tmp/cceJiy7O.s 			page 12


 104 0044 93F89030 		ldrb	r3, [r3, #144]	@ zero_extendqisi2
 105 0048 082B     		cmp	r3, #8
 106 004a 00F22781 		bhi	.L29
 107 004e DFE813F0 		tbh	[pc, r3, lsl #1]
 108              	.L8:
 109 0052 0900     		.2byte	(.L7-.L8)/2
 110 0054 2501     		.2byte	(.L29-.L8)/2
 111 0056 4300     		.2byte	(.L9-.L8)/2
 112 0058 9D00     		.2byte	(.L10-.L8)/2
 113 005a 1300     		.2byte	(.L11-.L8)/2
 114 005c D200     		.2byte	(.L12-.L8)/2
 115 005e 2501     		.2byte	(.L29-.L8)/2
 116 0060 2501     		.2byte	(.L29-.L8)/2
 117 0062 1E01     		.2byte	(.L13-.L8)/2
 118              		.p2align 1
 119              	.L7:
 345:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         MSC_Handle->timer = phost->Timer;
 120              		.loc 1 345 0
 121 0064 3423     		movs	r3, #52
 122 0066 03FB0143 		mla	r3, r3, r1, r4
 123 006a 0422     		movs	r2, #4
 124 006c 83F89020 		strb	r2, [r3, #144]
 346:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         
 125              		.loc 1 346 0
 126 0070 D0F8B833 		ldr	r3, [r0, #952]
 127 0074 C4F8FC30 		str	r3, [r4, #252]
 128              	.L11:
 349:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         
 129              		.loc 1 349 0
 130 0078 3422     		movs	r2, #52
 131 007a 02FB01F2 		mul	r2, r2, r1
 132 007e 9832     		adds	r2, r2, #152
 133 0080 2244     		add	r2, r2, r4
 134 0082 0732     		adds	r2, r2, #7
 135 0084 C9B2     		uxtb	r1, r1
 136 0086 3046     		mov	r0, r6
 137              	.LVL8:
 138 0088 FFF7FEFF 		bl	USBH_MSC_SCSI_Inquiry
 139              	.LVL9:
 351:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         {
 140              		.loc 1 351 0
 141 008c 0346     		mov	r3, r0
 142 008e 38B9     		cbnz	r0, .L14
 356:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         }
 143              		.loc 1 356 0
 144 0090 B4F8F820 		ldrh	r2, [r4, #248]
 145 0094 3421     		movs	r1, #52
 146 0096 01FB0242 		mla	r2, r1, r2, r4
 147 009a 0221     		movs	r1, #2
 148 009c 82F89010 		strb	r1, [r2, #144]
 149              	.L14:
 358:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         {
 150              		.loc 1 358 0
 151 00a0 022B     		cmp	r3, #2
 152 00a2 03D0     		beq	.L36
 362:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         {
 153              		.loc 1 362 0
ARM GAS  /tmp/cceJiy7O.s 			page 13


 154 00a4 042B     		cmp	r3, #4
 155 00a6 0BD0     		beq	.L37
 328:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   USBH_StatusTypeDef scsi_status = USBH_BUSY ;  
 156              		.loc 1 328 0
 157 00a8 0120     		movs	r0, #1
 158              	.LVL10:
 159 00aa B3E7     		b	.L5
 160              	.LVL11:
 161              	.L36:
 360:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         }
 162              		.loc 1 360 0
 163 00ac B4F8F830 		ldrh	r3, [r4, #248]
 164 00b0 3422     		movs	r2, #52
 165 00b2 02FB0344 		mla	r4, r2, r3, r4
 166              	.LVL12:
 167 00b6 0523     		movs	r3, #5
 168 00b8 84F89030 		strb	r3, [r4, #144]
 328:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   USBH_StatusTypeDef scsi_status = USBH_BUSY ;  
 169              		.loc 1 328 0
 170 00bc 0120     		movs	r0, #1
 171              	.LVL13:
 172 00be A9E7     		b	.L5
 173              	.LVL14:
 174              	.L37:
 364:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           MSC_Handle->unit[MSC_Handle->current_lun].error = MSC_ERROR;
 175              		.loc 1 364 0
 176 00c0 B4F8F830 		ldrh	r3, [r4, #248]
 177 00c4 3422     		movs	r2, #52
 178 00c6 02FB0344 		mla	r4, r2, r3, r4
 179              	.LVL15:
 180 00ca 0120     		movs	r0, #1
 181              	.LVL16:
 182 00cc 84F89000 		strb	r0, [r4, #144]
 365:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         }
 183              		.loc 1 365 0
 184 00d0 0223     		movs	r3, #2
 185 00d2 84F89130 		strb	r3, [r4, #145]
 186 00d6 9DE7     		b	.L5
 187              	.LVL17:
 188              	.L9:
 370:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         
 189              		.loc 1 370 0
 190 00d8 C9B2     		uxtb	r1, r1
 191 00da FFF7FEFF 		bl	USBH_MSC_SCSI_TestUnitReady
 192              	.LVL18:
 372:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         {
 193              		.loc 1 372 0
 194 00de 0246     		mov	r2, r0
 195 00e0 C0B9     		cbnz	r0, .L16
 374:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           {
 196              		.loc 1 374 0
 197 00e2 B4F8F830 		ldrh	r3, [r4, #248]
 198 00e6 3421     		movs	r1, #52
 199 00e8 01FB0341 		mla	r1, r1, r3, r4
 200 00ec 91F89210 		ldrb	r1, [r1, #146]	@ zero_extendqisi2
 201 00f0 B1B1     		cbz	r1, .L17
 376:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****             USBH_UsrLog ("MSC Device ready");
ARM GAS  /tmp/cceJiy7O.s 			page 14


 202              		.loc 1 376 0
 203 00f2 3421     		movs	r1, #52
 204 00f4 01FB0341 		mla	r1, r1, r3, r4
 205 00f8 0120     		movs	r0, #1
 206              	.LVL19:
 207 00fa 81F8C100 		strb	r0, [r1, #193]
 208              	.L18:
 383:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           MSC_Handle->unit[MSC_Handle->current_lun].error = MSC_OK;
 209              		.loc 1 383 0
 210 00fe 3421     		movs	r1, #52
 211 0100 01FB0343 		mla	r3, r1, r3, r4
 212 0104 0321     		movs	r1, #3
 213 0106 83F89010 		strb	r1, [r3, #144]
 384:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           MSC_Handle->unit[MSC_Handle->current_lun].prev_ready_state = USBH_OK;
 214              		.loc 1 384 0
 215 010a 0021     		movs	r1, #0
 216 010c 83F89110 		strb	r1, [r3, #145]
 385:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         }
 217              		.loc 1 385 0
 218 0110 83F89210 		strb	r1, [r3, #146]
 219              	.L16:
 387:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         {
 220              		.loc 1 387 0
 221 0114 022A     		cmp	r2, #2
 222 0116 0AD0     		beq	.L38
 403:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         {
 223              		.loc 1 403 0
 224 0118 042A     		cmp	r2, #4
 225 011a 2BD0     		beq	.L39
 328:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   USBH_StatusTypeDef scsi_status = USBH_BUSY ;  
 226              		.loc 1 328 0
 227 011c 0120     		movs	r0, #1
 228 011e 79E7     		b	.L5
 229              	.LVL20:
 230              	.L17:
 381:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           }
 231              		.loc 1 381 0
 232 0120 3421     		movs	r1, #52
 233 0122 01FB0341 		mla	r1, r1, r3, r4
 234 0126 0020     		movs	r0, #0
 235              	.LVL21:
 236 0128 81F8C100 		strb	r0, [r1, #193]
 237 012c E7E7     		b	.L18
 238              	.L38:
 390:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           {
 239              		.loc 1 390 0
 240 012e B4F8F830 		ldrh	r3, [r4, #248]
 241 0132 3422     		movs	r2, #52
 242 0134 02FB0342 		mla	r2, r2, r3, r4
 243 0138 92F89220 		ldrb	r2, [r2, #146]	@ zero_extendqisi2
 244 013c 022A     		cmp	r2, #2
 245 013e 12D0     		beq	.L20
 392:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****             USBH_UsrLog ("MSC Device NOT ready");
 246              		.loc 1 392 0
 247 0140 3422     		movs	r2, #52
 248 0142 02FB0342 		mla	r2, r2, r3, r4
 249 0146 0121     		movs	r1, #1
ARM GAS  /tmp/cceJiy7O.s 			page 15


 250 0148 82F8C110 		strb	r1, [r2, #193]
 251              	.L21:
 399:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****             MSC_Handle->unit[MSC_Handle->current_lun].error = MSC_NOT_READY;
 252              		.loc 1 399 0
 253 014c 3422     		movs	r2, #52
 254 014e 02FB0344 		mla	r4, r2, r3, r4
 255              	.LVL22:
 256 0152 0523     		movs	r3, #5
 257 0154 84F89030 		strb	r3, [r4, #144]
 400:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****             MSC_Handle->unit[MSC_Handle->current_lun].prev_ready_state = USBH_FAIL;
 258              		.loc 1 400 0
 259 0158 0120     		movs	r0, #1
 260 015a 84F89100 		strb	r0, [r4, #145]
 401:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         }
 261              		.loc 1 401 0
 262 015e 0223     		movs	r3, #2
 263 0160 84F89230 		strb	r3, [r4, #146]
 264 0164 56E7     		b	.L5
 265              	.LVL23:
 266              	.L20:
 397:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           }         
 267              		.loc 1 397 0
 268 0166 3422     		movs	r2, #52
 269 0168 02FB0342 		mla	r2, r2, r3, r4
 270 016c 0021     		movs	r1, #0
 271 016e 82F8C110 		strb	r1, [r2, #193]
 272 0172 EBE7     		b	.L21
 273              	.L39:
 405:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           MSC_Handle->unit[MSC_Handle->current_lun].error = MSC_ERROR;
 274              		.loc 1 405 0
 275 0174 B4F8F830 		ldrh	r3, [r4, #248]
 276 0178 3422     		movs	r2, #52
 277 017a 02FB0344 		mla	r4, r2, r3, r4
 278              	.LVL24:
 279 017e 0120     		movs	r0, #1
 280 0180 84F89000 		strb	r0, [r4, #144]
 406:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         }
 281              		.loc 1 406 0
 282 0184 0223     		movs	r3, #2
 283 0186 84F89130 		strb	r3, [r4, #145]
 284 018a 43E7     		b	.L5
 285              	.LVL25:
 286              	.L10:
 411:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         
 287              		.loc 1 411 0
 288 018c 3422     		movs	r2, #52
 289 018e 02FB01F2 		mul	r2, r2, r1
 290 0192 9032     		adds	r2, r2, #144
 291 0194 2244     		add	r2, r2, r4
 292 0196 0432     		adds	r2, r2, #4
 293 0198 C9B2     		uxtb	r1, r1
 294 019a FFF7FEFF 		bl	USBH_MSC_SCSI_ReadCapacity
 295              	.LVL26:
 413:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         {
 296              		.loc 1 413 0
 297 019e 28B1     		cbz	r0, .L40
 426:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         {
ARM GAS  /tmp/cceJiy7O.s 			page 16


 298              		.loc 1 426 0
 299 01a0 0228     		cmp	r0, #2
 300 01a2 12D0     		beq	.L41
 430:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         {
 301              		.loc 1 430 0
 302 01a4 0428     		cmp	r0, #4
 303 01a6 1AD0     		beq	.L42
 328:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   USBH_StatusTypeDef scsi_status = USBH_BUSY ;  
 304              		.loc 1 328 0
 305 01a8 0120     		movs	r0, #1
 306              	.LVL27:
 307 01aa 33E7     		b	.L5
 308              	.LVL28:
 309              	.L40:
 415:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           {
 310              		.loc 1 415 0
 311 01ac B4F8F830 		ldrh	r3, [r4, #248]
 422:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           MSC_Handle->unit[MSC_Handle->current_lun].error = MSC_OK;
 312              		.loc 1 422 0
 313 01b0 3422     		movs	r2, #52
 314 01b2 02FB0342 		mla	r2, r2, r3, r4
 315 01b6 0120     		movs	r0, #1
 316              	.LVL29:
 317 01b8 82F89000 		strb	r0, [r2, #144]
 423:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           MSC_Handle->current_lun++;
 318              		.loc 1 423 0
 319 01bc 0021     		movs	r1, #0
 320 01be 82F89110 		strb	r1, [r2, #145]
 424:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         }
 321              		.loc 1 424 0
 322 01c2 0344     		add	r3, r3, r0
 323 01c4 A4F8F830 		strh	r3, [r4, #248]	@ movhi
 324 01c8 24E7     		b	.L5
 325              	.LVL30:
 326              	.L41:
 428:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         }
 327              		.loc 1 428 0
 328 01ca B4F8F830 		ldrh	r3, [r4, #248]
 329 01ce 3422     		movs	r2, #52
 330 01d0 02FB0344 		mla	r4, r2, r3, r4
 331              	.LVL31:
 332 01d4 0523     		movs	r3, #5
 333 01d6 84F89030 		strb	r3, [r4, #144]
 328:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   USBH_StatusTypeDef scsi_status = USBH_BUSY ;  
 334              		.loc 1 328 0
 335 01da 0120     		movs	r0, #1
 336              	.LVL32:
 337 01dc 1AE7     		b	.L5
 338              	.LVL33:
 339              	.L42:
 432:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           MSC_Handle->unit[MSC_Handle->current_lun].error = MSC_ERROR;
 340              		.loc 1 432 0
 341 01de B4F8F830 		ldrh	r3, [r4, #248]
 342 01e2 3422     		movs	r2, #52
 343 01e4 02FB0344 		mla	r4, r2, r3, r4
 344              	.LVL34:
 345 01e8 0120     		movs	r0, #1
ARM GAS  /tmp/cceJiy7O.s 			page 17


 346              	.LVL35:
 347 01ea 84F89000 		strb	r0, [r4, #144]
 433:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         }
 348              		.loc 1 433 0
 349 01ee 0223     		movs	r3, #2
 350 01f0 84F89130 		strb	r3, [r4, #145]
 351 01f4 0EE7     		b	.L5
 352              	.LVL36:
 353              	.L12:
 438:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         
 354              		.loc 1 438 0
 355 01f6 3422     		movs	r2, #52
 356 01f8 02FB01F2 		mul	r2, r2, r1
 357 01fc 9832     		adds	r2, r2, #152
 358 01fe 2244     		add	r2, r2, r4
 359 0200 0432     		adds	r2, r2, #4
 360 0202 C9B2     		uxtb	r1, r1
 361 0204 FFF7FEFF 		bl	USBH_MSC_SCSI_RequestSense
 362              	.LVL37:
 440:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         {
 363              		.loc 1 440 0
 364 0208 0346     		mov	r3, r0
 365 020a 98B9     		cbnz	r0, .L24
 442:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****              (MSC_Handle->unit[MSC_Handle->current_lun].sense.key == SCSI_SENSE_KEY_NOT_READY) )   
 366              		.loc 1 442 0
 367 020c B4F8F820 		ldrh	r2, [r4, #248]
 368 0210 3421     		movs	r1, #52
 369 0212 01FB0241 		mla	r1, r1, r2, r4
 370 0216 91F89C10 		ldrb	r1, [r1, #156]	@ zero_extendqisi2
 371 021a 0629     		cmp	r1, #6
 372 021c 10D0     		beq	.L25
 442:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****              (MSC_Handle->unit[MSC_Handle->current_lun].sense.key == SCSI_SENSE_KEY_NOT_READY) )   
 373              		.loc 1 442 0 is_stmt 0 discriminator 1
 374 021e 0229     		cmp	r1, #2
 375 0220 0ED0     		beq	.L25
 376              	.LVL38:
 377              	.L26:
 456:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           MSC_Handle->current_lun++;
 378              		.loc 1 456 0 is_stmt 1
 379 0222 3421     		movs	r1, #52
 380 0224 01FB0241 		mla	r1, r1, r2, r4
 381 0228 0120     		movs	r0, #1
 382 022a 81F89000 		strb	r0, [r1, #144]
 457:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         }
 383              		.loc 1 457 0
 384 022e 0244     		add	r2, r2, r0
 385 0230 A4F8F820 		strh	r2, [r4, #248]	@ movhi
 386              	.L24:
 459:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         {
 387              		.loc 1 459 0
 388 0234 022B     		cmp	r3, #2
 389 0236 14D0     		beq	.L43
 464:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         {
 390              		.loc 1 464 0
 391 0238 042B     		cmp	r3, #4
 392 023a 1CD0     		beq	.L44
 328:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   USBH_StatusTypeDef scsi_status = USBH_BUSY ;  
ARM GAS  /tmp/cceJiy7O.s 			page 18


 393              		.loc 1 328 0
 394 023c 0120     		movs	r0, #1
 395 023e E9E6     		b	.L5
 396              	.LVL39:
 397              	.L25:
 446:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****             {
 398              		.loc 1 446 0
 399 0240 D6F8B813 		ldr	r1, [r6, #952]
 400 0244 D4F8FC00 		ldr	r0, [r4, #252]
 401              	.LVL40:
 402 0248 091A     		subs	r1, r1, r0
 403 024a 42F20F70 		movw	r0, #9999
 404 024e 8142     		cmp	r1, r0
 405 0250 E7D8     		bhi	.L26
 448:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****               break;
 406              		.loc 1 448 0
 407 0252 3423     		movs	r3, #52
 408 0254 03FB0242 		mla	r2, r3, r2, r4
 409 0258 0223     		movs	r3, #2
 410 025a 82F89030 		strb	r3, [r2, #144]
 328:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   USBH_StatusTypeDef scsi_status = USBH_BUSY ;  
 411              		.loc 1 328 0
 412 025e 0120     		movs	r0, #1
 449:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****             }        
 413              		.loc 1 449 0
 414 0260 D8E6     		b	.L5
 415              	.L43:
 462:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         }
 416              		.loc 1 462 0
 417 0262 B4F8F830 		ldrh	r3, [r4, #248]
 418 0266 3422     		movs	r2, #52
 419 0268 02FB0344 		mla	r4, r2, r3, r4
 420              	.LVL41:
 421 026c 0823     		movs	r3, #8
 422 026e 84F89030 		strb	r3, [r4, #144]
 328:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   USBH_StatusTypeDef scsi_status = USBH_BUSY ;  
 423              		.loc 1 328 0
 424 0272 0120     		movs	r0, #1
 425 0274 CEE6     		b	.L5
 426              	.LVL42:
 427              	.L44:
 466:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           MSC_Handle->unit[MSC_Handle->current_lun].error = MSC_ERROR;   
 428              		.loc 1 466 0
 429 0276 B4F8F830 		ldrh	r3, [r4, #248]
 430 027a 3422     		movs	r2, #52
 431 027c 02FB0344 		mla	r4, r2, r3, r4
 432              	.LVL43:
 433 0280 0120     		movs	r0, #1
 434 0282 84F89000 		strb	r0, [r4, #144]
 467:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         }
 435              		.loc 1 467 0
 436 0286 0223     		movs	r3, #2
 437 0288 84F89130 		strb	r3, [r4, #145]
 438 028c C2E6     		b	.L5
 439              	.LVL44:
 440              	.L13:
 472:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         break;  
ARM GAS  /tmp/cceJiy7O.s 			page 19


 441              		.loc 1 472 0
 442 028e 0131     		adds	r1, r1, #1
 443 0290 A4F8F810 		strh	r1, [r4, #248]	@ movhi
 328:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   USBH_StatusTypeDef scsi_status = USBH_BUSY ;  
 444              		.loc 1 328 0
 445 0294 0120     		movs	r0, #1
 446              	.LVL45:
 473:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         
 447              		.loc 1 473 0
 448 0296 BDE6     		b	.L5
 449              	.LVL46:
 450              	.L28:
 495:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     break;
 451              		.loc 1 495 0
 452 0298 0020     		movs	r0, #0
 453              	.LVL47:
 454 029a BBE6     		b	.L5
 455              	.LVL48:
 456              	.L29:
 328:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   USBH_StatusTypeDef scsi_status = USBH_BUSY ;  
 457              		.loc 1 328 0
 458 029c 0120     		movs	r0, #1
 459              	.LVL49:
 460 029e B9E6     		b	.L5
 461              		.cfi_endproc
 462              	.LFE69:
 464              		.section	.text.USBH_MSC_ClassRequest,"ax",%progbits
 465              		.align	1
 466              		.syntax unified
 467              		.thumb
 468              		.thumb_func
 469              		.fpu softvfp
 471              	USBH_MSC_ClassRequest:
 472              	.LFB68:
 270:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   MSC_HandleTypeDef *MSC_Handle =  (MSC_HandleTypeDef *) phost->pActiveClass->pData;  
 473              		.loc 1 270 0
 474              		.cfi_startproc
 475              		@ args = 0, pretend = 0, frame = 0
 476              		@ frame_needed = 0, uses_anonymous_args = 0
 477              	.LVL50:
 478 0000 38B5     		push	{r3, r4, r5, lr}
 479              	.LCFI1:
 480              		.cfi_def_cfa_offset 16
 481              		.cfi_offset 3, -16
 482              		.cfi_offset 4, -12
 483              		.cfi_offset 5, -8
 484              		.cfi_offset 14, -4
 271:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   USBH_StatusTypeDef status = USBH_BUSY;
 485              		.loc 1 271 0
 486 0002 D0F87433 		ldr	r3, [r0, #884]
 487 0006 DC69     		ldr	r4, [r3, #28]
 488              	.LVL51:
 276:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   {
 489              		.loc 1 276 0
 490 0008 A37B     		ldrb	r3, [r4, #14]	@ zero_extendqisi2
 491 000a 022B     		cmp	r3, #2
 492 000c 04D0     		beq	.L47
ARM GAS  /tmp/cceJiy7O.s 			page 20


 493 000e 032B     		cmp	r3, #3
 494 0010 1FD0     		beq	.L48
 495 0012 0BB1     		cbz	r3, .L47
 272:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   uint8_t i;
 496              		.loc 1 272 0
 497 0014 0120     		movs	r0, #1
 498              	.LVL52:
 499              	.L46:
 317:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** 
 500              		.loc 1 317 0
 501 0016 38BD     		pop	{r3, r4, r5, pc}
 502              	.LVL53:
 503              	.L47:
 281:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     
 504              		.loc 1 281 0
 505 0018 2146     		mov	r1, r4
 506 001a FFF7FEFF 		bl	USBH_MSC_BOT_REQ_GetMaxLUN
 507              	.LVL54:
 285:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     {
 508              		.loc 1 285 0
 509 001e 0328     		cmp	r0, #3
 510 0020 06D0     		beq	.L57
 291:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     {
 511              		.loc 1 291 0
 512 0022 0028     		cmp	r0, #0
 513 0024 F7D1     		bne	.L46
 514              	.LVL55:
 515              	.L50:
 293:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       USBH_UsrLog ("Number of supported LUN: %lu", (int32_t)(MSC_Handle->max_lun));
 516              		.loc 1 293 0
 517 0026 2578     		ldrb	r5, [r4]	@ zero_extendqisi2
 518 0028 0135     		adds	r5, r5, #1
 519 002a 2560     		str	r5, [r4]
 520              	.LVL56:
 296:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       {
 521              		.loc 1 296 0
 522 002c 0023     		movs	r3, #0
 523 002e 0DE0     		b	.L51
 524              	.LVL57:
 525              	.L57:
 287:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       status = USBH_OK;
 526              		.loc 1 287 0
 527 0030 0020     		movs	r0, #0
 528              	.LVL58:
 529 0032 2060     		str	r0, [r4]
 530              	.LVL59:
 531 0034 F7E7     		b	.L50
 532              	.LVL60:
 533              	.L52:
 298:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         MSC_Handle->unit[i].state_changed = 0;
 534              		.loc 1 298 0 discriminator 3
 535 0036 3422     		movs	r2, #52
 536 0038 02FB0342 		mla	r2, r2, r3, r4
 537 003c 0221     		movs	r1, #2
 538 003e 82F89210 		strb	r1, [r2, #146]
 299:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       }
 539              		.loc 1 299 0 discriminator 3
ARM GAS  /tmp/cceJiy7O.s 			page 21


 540 0042 0021     		movs	r1, #0
 541 0044 82F8C110 		strb	r1, [r2, #193]
 296:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       {
 542              		.loc 1 296 0 discriminator 3
 543 0048 0133     		adds	r3, r3, #1
 544              	.LVL61:
 545 004a DBB2     		uxtb	r3, r3
 546              	.LVL62:
 547              	.L51:
 296:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       {
 548              		.loc 1 296 0 is_stmt 0 discriminator 1
 549 004c 9D42     		cmp	r5, r3
 550 004e F2D8     		bhi	.L52
 551 0050 E1E7     		b	.L46
 552              	.LVL63:
 553              	.L48:
 306:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     {
 554              		.loc 1 306 0 is_stmt 1
 555 0052 0021     		movs	r1, #0
 556 0054 FFF7FEFF 		bl	USBH_ClrFeature
 557              	.LVL64:
 558 0058 18B9     		cbnz	r0, .L54
 308:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     }    
 559              		.loc 1 308 0
 560 005a E37B     		ldrb	r3, [r4, #15]	@ zero_extendqisi2
 561 005c A373     		strb	r3, [r4, #14]
 272:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   uint8_t i;
 562              		.loc 1 272 0
 563 005e 0120     		movs	r0, #1
 564 0060 D9E7     		b	.L46
 565              	.L54:
 566 0062 0120     		movs	r0, #1
 567 0064 D7E7     		b	.L46
 568              		.cfi_endproc
 569              	.LFE68:
 571              		.section	.text.USBH_MSC_InterfaceDeInit,"ax",%progbits
 572              		.align	1
 573              		.syntax unified
 574              		.thumb
 575              		.thumb_func
 576              		.fpu softvfp
 578              	USBH_MSC_InterfaceDeInit:
 579              	.LFB67:
 236:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   MSC_HandleTypeDef *MSC_Handle =  (MSC_HandleTypeDef *) phost->pActiveClass->pData;
 580              		.loc 1 236 0
 581              		.cfi_startproc
 582              		@ args = 0, pretend = 0, frame = 0
 583              		@ frame_needed = 0, uses_anonymous_args = 0
 584              	.LVL65:
 585 0000 38B5     		push	{r3, r4, r5, lr}
 586              	.LCFI2:
 587              		.cfi_def_cfa_offset 16
 588              		.cfi_offset 3, -16
 589              		.cfi_offset 4, -12
 590              		.cfi_offset 5, -8
 591              		.cfi_offset 14, -4
 592 0002 0446     		mov	r4, r0
ARM GAS  /tmp/cceJiy7O.s 			page 22


 237:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** 
 593              		.loc 1 237 0
 594 0004 D0F87433 		ldr	r3, [r0, #884]
 595 0008 DD69     		ldr	r5, [r3, #28]
 596              	.LVL66:
 239:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   {
 597              		.loc 1 239 0
 598 000a 6979     		ldrb	r1, [r5, #5]	@ zero_extendqisi2
 599 000c 69B9     		cbnz	r1, .L63
 600              	.LVL67:
 601              	.L59:
 246:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   {
 602              		.loc 1 246 0
 603 000e 2979     		ldrb	r1, [r5, #4]	@ zero_extendqisi2
 604 0010 A1B9     		cbnz	r1, .L64
 605              	.L60:
 253:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   {
 606              		.loc 1 253 0
 607 0012 D4F87433 		ldr	r3, [r4, #884]
 608 0016 D869     		ldr	r0, [r3, #28]
 609 0018 28B1     		cbz	r0, .L61
 255:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     phost->pActiveClass->pData = 0;
 610              		.loc 1 255 0
 611 001a FFF7FEFF 		bl	free
 612              	.LVL68:
 256:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   }
 613              		.loc 1 256 0
 614 001e D4F87433 		ldr	r3, [r4, #884]
 615 0022 0022     		movs	r2, #0
 616 0024 DA61     		str	r2, [r3, #28]
 617              	.L61:
 260:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** 
 618              		.loc 1 260 0
 619 0026 0020     		movs	r0, #0
 620 0028 38BD     		pop	{r3, r4, r5, pc}
 621              	.LVL69:
 622              	.L63:
 241:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     USBH_FreePipe  (phost, MSC_Handle->OutPipe);
 623              		.loc 1 241 0
 624 002a FFF7FEFF 		bl	USBH_ClosePipe
 625              	.LVL70:
 242:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     MSC_Handle->OutPipe = 0;     /* Reset the Channel as Free */
 626              		.loc 1 242 0
 627 002e 6979     		ldrb	r1, [r5, #5]	@ zero_extendqisi2
 628 0030 2046     		mov	r0, r4
 629 0032 FFF7FEFF 		bl	USBH_FreePipe
 630              	.LVL71:
 243:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   }
 631              		.loc 1 243 0
 632 0036 0023     		movs	r3, #0
 633 0038 6B71     		strb	r3, [r5, #5]
 634 003a E8E7     		b	.L59
 635              	.L64:
 248:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     USBH_FreePipe  (phost, MSC_Handle->InPipe);
 636              		.loc 1 248 0
 637 003c 2046     		mov	r0, r4
 638 003e FFF7FEFF 		bl	USBH_ClosePipe
ARM GAS  /tmp/cceJiy7O.s 			page 23


 639              	.LVL72:
 249:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     MSC_Handle->InPipe = 0;     /* Reset the Channel as Free */
 640              		.loc 1 249 0
 641 0042 2979     		ldrb	r1, [r5, #4]	@ zero_extendqisi2
 642 0044 2046     		mov	r0, r4
 643 0046 FFF7FEFF 		bl	USBH_FreePipe
 644              	.LVL73:
 250:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   } 
 645              		.loc 1 250 0
 646 004a 0023     		movs	r3, #0
 647 004c 2B71     		strb	r3, [r5, #4]
 648 004e E0E7     		b	.L60
 649              		.cfi_endproc
 650              	.LFE67:
 652              		.section	.text.USBH_MSC_InterfaceInit,"ax",%progbits
 653              		.align	1
 654              		.syntax unified
 655              		.thumb
 656              		.thumb_func
 657              		.fpu softvfp
 659              	USBH_MSC_InterfaceInit:
 660              	.LFB66:
 150:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   uint8_t interface = 0; 
 661              		.loc 1 150 0
 662              		.cfi_startproc
 663              		@ args = 0, pretend = 0, frame = 0
 664              		@ frame_needed = 0, uses_anonymous_args = 0
 665              	.LVL74:
 666 0000 F0B5     		push	{r4, r5, r6, r7, lr}
 667              	.LCFI3:
 668              		.cfi_def_cfa_offset 20
 669              		.cfi_offset 4, -20
 670              		.cfi_offset 5, -16
 671              		.cfi_offset 6, -12
 672              		.cfi_offset 7, -8
 673              		.cfi_offset 14, -4
 674 0002 85B0     		sub	sp, sp, #20
 675              	.LCFI4:
 676              		.cfi_def_cfa_offset 40
 677 0004 0446     		mov	r4, r0
 678              	.LVL75:
 155:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   
 679              		.loc 1 155 0
 680 0006 D0F87413 		ldr	r1, [r0, #884]
 681 000a 5023     		movs	r3, #80
 682 000c 0622     		movs	r2, #6
 683 000e 0979     		ldrb	r1, [r1, #4]	@ zero_extendqisi2
 684 0010 FFF7FEFF 		bl	USBH_FindInterface
 685              	.LVL76:
 157:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   {
 686              		.loc 1 157 0
 687 0014 FF28     		cmp	r0, #255
 688 0016 00F08980 		beq	.L71
 164:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     
 689              		.loc 1 164 0
 690 001a 0146     		mov	r1, r0
 691 001c 2046     		mov	r0, r4
ARM GAS  /tmp/cceJiy7O.s 			page 24


 692              	.LVL77:
 693 001e FFF7FEFF 		bl	USBH_SelectInterface
 694              	.LVL78:
 166:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     MSC_Handle =  (MSC_HandleTypeDef *) phost->pActiveClass->pData;
 695              		.loc 1 166 0
 696 0022 D4F87453 		ldr	r5, [r4, #884]
 697 0026 4FF48070 		mov	r0, #256
 698 002a FFF7FEFF 		bl	malloc
 699              	.LVL79:
 700 002e E861     		str	r0, [r5, #28]
 167:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     
 701              		.loc 1 167 0
 702 0030 D4F87433 		ldr	r3, [r4, #884]
 703 0034 DD69     		ldr	r5, [r3, #28]
 704              	.LVL80:
 169:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     {
 705              		.loc 1 169 0
 706 0036 94F81F33 		ldrb	r3, [r4, #799]	@ zero_extendqisi2
 707 003a 1A22     		movs	r2, #26
 708 003c 02FB0343 		mla	r3, r2, r3, r4
 709 0040 93F84833 		ldrb	r3, [r3, #840]	@ zero_extendqisi2
 710 0044 13F0800F 		tst	r3, #128
 711 0048 5ED1     		bne	.L73
 176:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       MSC_Handle->OutEpSize  = phost->device.CfgDesc.Itf_Desc[phost->device.current_interface].Ep_D
 712              		.loc 1 176 0
 713 004a AB71     		strb	r3, [r5, #6]
 177:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     }
 714              		.loc 1 177 0
 715 004c 94F81F33 		ldrb	r3, [r4, #799]	@ zero_extendqisi2
 716 0050 1A22     		movs	r2, #26
 717 0052 02FB0343 		mla	r3, r2, r3, r4
 718 0056 B3F84A33 		ldrh	r3, [r3, #842]
 719 005a 2B81     		strh	r3, [r5, #8]	@ movhi
 720              	.L68:
 180:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     {
 721              		.loc 1 180 0
 722 005c 94F81F33 		ldrb	r3, [r4, #799]	@ zero_extendqisi2
 723 0060 1A22     		movs	r2, #26
 724 0062 02FB0343 		mla	r3, r2, r3, r4
 725 0066 93F85033 		ldrb	r3, [r3, #848]	@ zero_extendqisi2
 726 006a 13F0800F 		tst	r3, #128
 727 006e 54D1     		bne	.L74
 187:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       MSC_Handle->OutEpSize  = phost->device.CfgDesc.Itf_Desc[phost->device.current_interface].Ep_D
 728              		.loc 1 187 0
 729 0070 AB71     		strb	r3, [r5, #6]
 188:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     }
 730              		.loc 1 188 0
 731 0072 94F81F33 		ldrb	r3, [r4, #799]	@ zero_extendqisi2
 732 0076 1A22     		movs	r2, #26
 733 0078 02FB0343 		mla	r3, r2, r3, r4
 734 007c B3F85233 		ldrh	r3, [r3, #850]
 735 0080 2B81     		strh	r3, [r5, #8]	@ movhi
 736              	.L70:
 191:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     MSC_Handle->rw_lun = 0;
 737              		.loc 1 191 0
 738 0082 0026     		movs	r6, #0
 739 0084 A5F8F860 		strh	r6, [r5, #248]	@ movhi
ARM GAS  /tmp/cceJiy7O.s 			page 25


 192:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     MSC_Handle->state = MSC_INIT;
 740              		.loc 1 192 0
 741 0088 A5F8FA60 		strh	r6, [r5, #250]	@ movhi
 193:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     MSC_Handle->error = MSC_OK;
 742              		.loc 1 193 0
 743 008c 2E73     		strb	r6, [r5, #12]
 194:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     MSC_Handle->req_state = MSC_REQ_IDLE;
 744              		.loc 1 194 0
 745 008e 6E73     		strb	r6, [r5, #13]
 195:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     MSC_Handle->OutPipe = USBH_AllocPipe(phost, MSC_Handle->OutEp);
 746              		.loc 1 195 0
 747 0090 AE73     		strb	r6, [r5, #14]
 196:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     MSC_Handle->InPipe = USBH_AllocPipe(phost, MSC_Handle->InEp);
 748              		.loc 1 196 0
 749 0092 A979     		ldrb	r1, [r5, #6]	@ zero_extendqisi2
 750 0094 2046     		mov	r0, r4
 751 0096 FFF7FEFF 		bl	USBH_AllocPipe
 752              	.LVL81:
 753 009a 6871     		strb	r0, [r5, #5]
 197:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** 
 754              		.loc 1 197 0
 755 009c E979     		ldrb	r1, [r5, #7]	@ zero_extendqisi2
 756 009e 2046     		mov	r0, r4
 757 00a0 FFF7FEFF 		bl	USBH_AllocPipe
 758              	.LVL82:
 759 00a4 2871     		strb	r0, [r5, #4]
 199:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     
 760              		.loc 1 199 0
 761 00a6 2046     		mov	r0, r4
 762 00a8 FFF7FEFF 		bl	USBH_MSC_BOT_Init
 763              	.LVL83:
 202:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     
 764              		.loc 1 202 0
 765 00ac 6822     		movs	r2, #104
 766 00ae 3146     		mov	r1, r6
 767 00b0 05F19000 		add	r0, r5, #144
 768 00b4 FFF7FEFF 		bl	memset
 769              	.LVL84:
 205:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****                     MSC_Handle->OutPipe,
 770              		.loc 1 205 0
 771 00b8 94F81C33 		ldrb	r3, [r4, #796]	@ zero_extendqisi2
 772 00bc AA79     		ldrb	r2, [r5, #6]	@ zero_extendqisi2
 773 00be 6979     		ldrb	r1, [r5, #5]	@ zero_extendqisi2
 774 00c0 2889     		ldrh	r0, [r5, #8]
 775 00c2 0290     		str	r0, [sp, #8]
 776 00c4 0227     		movs	r7, #2
 777 00c6 0197     		str	r7, [sp, #4]
 778 00c8 94F81D03 		ldrb	r0, [r4, #797]	@ zero_extendqisi2
 779 00cc 0090     		str	r0, [sp]
 780 00ce 2046     		mov	r0, r4
 781 00d0 FFF7FEFF 		bl	USBH_OpenPipe
 782              	.LVL85:
 213:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****                     MSC_Handle->InPipe,
 783              		.loc 1 213 0
 784 00d4 94F81C33 		ldrb	r3, [r4, #796]	@ zero_extendqisi2
 785 00d8 EA79     		ldrb	r2, [r5, #7]	@ zero_extendqisi2
 786 00da 2979     		ldrb	r1, [r5, #4]	@ zero_extendqisi2
ARM GAS  /tmp/cceJiy7O.s 			page 26


 787 00dc 6889     		ldrh	r0, [r5, #10]
 788 00de 0290     		str	r0, [sp, #8]
 789 00e0 0197     		str	r7, [sp, #4]
 790 00e2 94F81D03 		ldrb	r0, [r4, #797]	@ zero_extendqisi2
 791 00e6 0090     		str	r0, [sp]
 792 00e8 2046     		mov	r0, r4
 793 00ea FFF7FEFF 		bl	USBH_OpenPipe
 794              	.LVL86:
 222:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     USBH_LL_SetToggle  (phost, MSC_Handle->OutPipe,0);
 795              		.loc 1 222 0
 796 00ee 3246     		mov	r2, r6
 797 00f0 2979     		ldrb	r1, [r5, #4]	@ zero_extendqisi2
 798 00f2 2046     		mov	r0, r4
 799 00f4 FFF7FEFF 		bl	USBH_LL_SetToggle
 800              	.LVL87:
 223:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     status = USBH_OK; 
 801              		.loc 1 223 0
 802 00f8 3246     		mov	r2, r6
 803 00fa 6979     		ldrb	r1, [r5, #5]	@ zero_extendqisi2
 804 00fc 2046     		mov	r0, r4
 805 00fe FFF7FEFF 		bl	USBH_LL_SetToggle
 806              	.LVL88:
 224:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   }
 807              		.loc 1 224 0
 808 0102 3046     		mov	r0, r6
 809              	.LVL89:
 810              	.L66:
 227:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** 
 811              		.loc 1 227 0
 812 0104 05B0     		add	sp, sp, #20
 813              	.LCFI5:
 814              		.cfi_remember_state
 815              		.cfi_def_cfa_offset 20
 816              		@ sp needed
 817 0106 F0BD     		pop	{r4, r5, r6, r7, pc}
 818              	.LVL90:
 819              	.L73:
 820              	.LCFI6:
 821              		.cfi_restore_state
 171:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       MSC_Handle->InEpSize  = phost->device.CfgDesc.Itf_Desc[phost->device.current_interface].Ep_De
 822              		.loc 1 171 0
 823 0108 EB71     		strb	r3, [r5, #7]
 172:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     }
 824              		.loc 1 172 0
 825 010a 94F81F33 		ldrb	r3, [r4, #799]	@ zero_extendqisi2
 826 010e 02FB0343 		mla	r3, r2, r3, r4
 827 0112 B3F84A33 		ldrh	r3, [r3, #842]
 828 0116 6B81     		strh	r3, [r5, #10]	@ movhi
 829 0118 A0E7     		b	.L68
 830              	.L74:
 182:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       MSC_Handle->InEpSize  = phost->device.CfgDesc.Itf_Desc[phost->device.current_interface].Ep_De
 831              		.loc 1 182 0
 832 011a EB71     		strb	r3, [r5, #7]
 183:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     }
 833              		.loc 1 183 0
 834 011c 94F81F33 		ldrb	r3, [r4, #799]	@ zero_extendqisi2
 835 0120 02FB0343 		mla	r3, r2, r3, r4
ARM GAS  /tmp/cceJiy7O.s 			page 27


 836 0124 B3F85233 		ldrh	r3, [r3, #850]
 837 0128 6B81     		strh	r3, [r5, #10]	@ movhi
 838 012a AAE7     		b	.L70
 839              	.LVL91:
 840              	.L71:
 160:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   }
 841              		.loc 1 160 0
 842 012c 0220     		movs	r0, #2
 843              	.LVL92:
 844 012e E9E7     		b	.L66
 845              		.cfi_endproc
 846              	.LFE66:
 848              		.section	.text.USBH_MSC_RdWrProcess,"ax",%progbits
 849              		.align	1
 850              		.syntax unified
 851              		.thumb
 852              		.thumb_func
 853              		.fpu softvfp
 855              	USBH_MSC_RdWrProcess:
 856              	.LFB71:
 516:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** /**
 517:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @brief  USBH_MSC_RdWrProcess 
 518:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   *         The function is for managing state machine for MSC I/O Process
 519:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @param  phost: Host handle
 520:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @param  lun: logical Unit Number
 521:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @retval USBH Status
 522:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   */
 523:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** static USBH_StatusTypeDef USBH_MSC_RdWrProcess(USBH_HandleTypeDef *phost, uint8_t lun)
 524:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** {
 857              		.loc 1 524 0
 858              		.cfi_startproc
 859              		@ args = 0, pretend = 0, frame = 0
 860              		@ frame_needed = 0, uses_anonymous_args = 0
 861              	.LVL93:
 862 0000 30B5     		push	{r4, r5, lr}
 863              	.LCFI7:
 864              		.cfi_def_cfa_offset 12
 865              		.cfi_offset 4, -12
 866              		.cfi_offset 5, -8
 867              		.cfi_offset 14, -4
 868 0002 83B0     		sub	sp, sp, #12
 869              	.LCFI8:
 870              		.cfi_def_cfa_offset 24
 871 0004 0C46     		mov	r4, r1
 525:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   MSC_HandleTypeDef *MSC_Handle =  (MSC_HandleTypeDef *) phost->pActiveClass->pData;
 872              		.loc 1 525 0
 873 0006 D0F87433 		ldr	r3, [r0, #884]
 874 000a DD69     		ldr	r5, [r3, #28]
 875              	.LVL94:
 526:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   USBH_StatusTypeDef error = USBH_BUSY ;
 527:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   USBH_StatusTypeDef scsi_status = USBH_BUSY ;  
 528:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   
 529:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   /* Switch MSC REQ state machine */
 530:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   switch (MSC_Handle->unit[lun].state)
 876              		.loc 1 530 0
 877 000c 3423     		movs	r3, #52
 878 000e 03FB0153 		mla	r3, r3, r1, r5
ARM GAS  /tmp/cceJiy7O.s 			page 28


 879 0012 93F89030 		ldrb	r3, [r3, #144]	@ zero_extendqisi2
 880 0016 062B     		cmp	r3, #6
 881 0018 07D0     		beq	.L77
 882 001a 072B     		cmp	r3, #7
 883 001c 29D0     		beq	.L78
 884 001e 052B     		cmp	r3, #5
 885 0020 4BD0     		beq	.L91
 526:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   USBH_StatusTypeDef error = USBH_BUSY ;
 886              		.loc 1 526 0
 887 0022 0123     		movs	r3, #1
 888              	.LVL95:
 889              	.L76:
 531:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   {
 532:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****  
 533:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   case MSC_READ: 
 534:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     scsi_status = USBH_MSC_SCSI_Read(phost,lun, 0, NULL, 0) ;
 535:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     
 536:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     if(scsi_status == USBH_OK)
 537:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     {
 538:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       MSC_Handle->unit[lun].state = MSC_IDLE;
 539:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       error = USBH_OK;     
 540:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     }
 541:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     else if( scsi_status == USBH_FAIL)
 542:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     {
 543:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       MSC_Handle->unit[lun].state = MSC_REQUEST_SENSE;  
 544:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     }
 545:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     else if(scsi_status == USBH_UNRECOVERED_ERROR)
 546:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     {
 547:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       MSC_Handle->unit[lun].state = MSC_UNRECOVERED_ERROR;
 548:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           error = USBH_FAIL;
 549:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     }
 550:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** #if (USBH_USE_OS == 1)
 551:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     osMessagePut ( phost->os_event, USBH_CLASS_EVENT, 0);
 552:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** #endif   
 553:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     break;     
 554:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     
 555:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   case MSC_WRITE: 
 556:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     scsi_status = USBH_MSC_SCSI_Write(phost,lun, 0, NULL, 0) ;
 557:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     
 558:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     if(scsi_status == USBH_OK)
 559:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     {
 560:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         MSC_Handle->unit[lun].state = MSC_IDLE;
 561:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         error = USBH_OK;             
 562:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     }
 563:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     else if( scsi_status == USBH_FAIL)
 564:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     {
 565:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       MSC_Handle->unit[lun].state = MSC_REQUEST_SENSE;  
 566:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     }
 567:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     else if(scsi_status == USBH_UNRECOVERED_ERROR)
 568:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     {
 569:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       MSC_Handle->unit[lun].state = MSC_UNRECOVERED_ERROR;
 570:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           error = USBH_FAIL;
 571:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     }
 572:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** #if (USBH_USE_OS == 1)
 573:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     osMessagePut ( phost->os_event, USBH_CLASS_EVENT, 0);
 574:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** #endif       
 575:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     break; 
ARM GAS  /tmp/cceJiy7O.s 			page 29


 576:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   
 577:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   case MSC_REQUEST_SENSE:
 578:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     scsi_status = USBH_MSC_SCSI_RequestSense(phost, lun, &MSC_Handle->unit[lun].sense);
 579:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     
 580:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     if( scsi_status == USBH_OK)
 581:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     {
 582:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       USBH_UsrLog ("Sense Key  : %x", MSC_Handle->unit[lun].sense.key);
 583:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       USBH_UsrLog ("Additional Sense Code : %x", MSC_Handle->unit[lun].sense.asc);
 584:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       USBH_UsrLog ("Additional Sense Code Qualifier: %x", MSC_Handle->unit[lun].sense.ascq);
 585:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       MSC_Handle->unit[lun].state = MSC_IDLE;
 586:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       MSC_Handle->unit[lun].error = MSC_ERROR;
 587:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       
 588:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       error = USBH_FAIL;
 589:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     }
 590:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     if( scsi_status == USBH_FAIL)
 591:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     {
 592:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       USBH_UsrLog ("MSC Device NOT ready");
 593:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     }
 594:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     else if(scsi_status == USBH_UNRECOVERED_ERROR)
 595:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     {
 596:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       MSC_Handle->unit[lun].state = MSC_UNRECOVERED_ERROR;  
 597:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           error = USBH_FAIL;
 598:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     }
 599:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** #if (USBH_USE_OS == 1)
 600:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     osMessagePut ( phost->os_event, USBH_CLASS_EVENT, 0);
 601:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** #endif       
 602:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     break;  
 603:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     
 604:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   default:
 605:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     break;  
 606:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     
 607:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   }
 608:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   return error;
 609:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** }
 890              		.loc 1 609 0
 891 0024 1846     		mov	r0, r3
 892 0026 03B0     		add	sp, sp, #12
 893              	.LCFI9:
 894              		.cfi_remember_state
 895              		.cfi_def_cfa_offset 12
 896              		@ sp needed
 897 0028 30BD     		pop	{r4, r5, pc}
 898              	.LVL96:
 899              	.L77:
 900              	.LCFI10:
 901              		.cfi_restore_state
 534:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     
 902              		.loc 1 534 0
 903 002a 0022     		movs	r2, #0
 904 002c 0092     		str	r2, [sp]
 905 002e 1346     		mov	r3, r2
 906 0030 FFF7FEFF 		bl	USBH_MSC_SCSI_Read
 907              	.LVL97:
 536:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     {
 908              		.loc 1 536 0
 909 0034 0346     		mov	r3, r0
 910 0036 28B1     		cbz	r0, .L92
ARM GAS  /tmp/cceJiy7O.s 			page 30


 541:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     {
 911              		.loc 1 541 0
 912 0038 0228     		cmp	r0, #2
 913 003a 0AD0     		beq	.L93
 545:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     {
 914              		.loc 1 545 0
 915 003c 0428     		cmp	r0, #4
 916 003e 10D0     		beq	.L94
 526:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   USBH_StatusTypeDef scsi_status = USBH_BUSY ;  
 917              		.loc 1 526 0
 918 0040 0123     		movs	r3, #1
 919 0042 EFE7     		b	.L76
 920              	.L92:
 538:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       error = USBH_OK;     
 921              		.loc 1 538 0
 922 0044 3422     		movs	r2, #52
 923 0046 02FB0454 		mla	r4, r2, r4, r5
 924 004a 0122     		movs	r2, #1
 925 004c 84F89020 		strb	r2, [r4, #144]
 926              	.LVL98:
 927 0050 E8E7     		b	.L76
 928              	.LVL99:
 929              	.L93:
 543:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     }
 930              		.loc 1 543 0
 931 0052 3423     		movs	r3, #52
 932 0054 03FB0454 		mla	r4, r3, r4, r5
 933 0058 0523     		movs	r3, #5
 934 005a 84F89030 		strb	r3, [r4, #144]
 526:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   USBH_StatusTypeDef scsi_status = USBH_BUSY ;  
 935              		.loc 1 526 0
 936 005e 0123     		movs	r3, #1
 937 0060 E0E7     		b	.L76
 938              	.L94:
 547:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           error = USBH_FAIL;
 939              		.loc 1 547 0
 940 0062 3423     		movs	r3, #52
 941 0064 03FB0454 		mla	r4, r3, r4, r5
 942 0068 0823     		movs	r3, #8
 943 006a 84F89030 		strb	r3, [r4, #144]
 944              	.LVL100:
 548:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     }
 945              		.loc 1 548 0
 946 006e 0223     		movs	r3, #2
 947 0070 D8E7     		b	.L76
 948              	.LVL101:
 949              	.L78:
 556:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     
 950              		.loc 1 556 0
 951 0072 0022     		movs	r2, #0
 952 0074 0092     		str	r2, [sp]
 953 0076 1346     		mov	r3, r2
 954 0078 FFF7FEFF 		bl	USBH_MSC_SCSI_Write
 955              	.LVL102:
 558:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     {
 956              		.loc 1 558 0
 957 007c 0346     		mov	r3, r0
ARM GAS  /tmp/cceJiy7O.s 			page 31


 958 007e 28B1     		cbz	r0, .L95
 563:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     {
 959              		.loc 1 563 0
 960 0080 0228     		cmp	r0, #2
 961 0082 0AD0     		beq	.L96
 567:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     {
 962              		.loc 1 567 0
 963 0084 0428     		cmp	r0, #4
 964 0086 10D0     		beq	.L97
 526:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   USBH_StatusTypeDef scsi_status = USBH_BUSY ;  
 965              		.loc 1 526 0
 966 0088 0123     		movs	r3, #1
 967 008a CBE7     		b	.L76
 968              	.L95:
 560:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****         error = USBH_OK;             
 969              		.loc 1 560 0
 970 008c 3422     		movs	r2, #52
 971 008e 02FB0454 		mla	r4, r2, r4, r5
 972 0092 0122     		movs	r2, #1
 973 0094 84F89020 		strb	r2, [r4, #144]
 974              	.LVL103:
 975 0098 C4E7     		b	.L76
 976              	.LVL104:
 977              	.L96:
 565:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     }
 978              		.loc 1 565 0
 979 009a 3423     		movs	r3, #52
 980 009c 03FB0454 		mla	r4, r3, r4, r5
 981 00a0 0523     		movs	r3, #5
 982 00a2 84F89030 		strb	r3, [r4, #144]
 526:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   USBH_StatusTypeDef scsi_status = USBH_BUSY ;  
 983              		.loc 1 526 0
 984 00a6 0123     		movs	r3, #1
 985 00a8 BCE7     		b	.L76
 986              	.L97:
 569:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           error = USBH_FAIL;
 987              		.loc 1 569 0
 988 00aa 3423     		movs	r3, #52
 989 00ac 03FB0454 		mla	r4, r3, r4, r5
 990 00b0 0823     		movs	r3, #8
 991 00b2 84F89030 		strb	r3, [r4, #144]
 992              	.LVL105:
 570:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     }
 993              		.loc 1 570 0
 994 00b6 0223     		movs	r3, #2
 995 00b8 B4E7     		b	.L76
 996              	.LVL106:
 997              	.L91:
 578:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     
 998              		.loc 1 578 0
 999 00ba 3422     		movs	r2, #52
 1000 00bc 02FB01F2 		mul	r2, r2, r1
 1001 00c0 9832     		adds	r2, r2, #152
 1002 00c2 2A44     		add	r2, r2, r5
 1003 00c4 0432     		adds	r2, r2, #4
 1004 00c6 FFF7FEFF 		bl	USBH_MSC_SCSI_RequestSense
 1005              	.LVL107:
ARM GAS  /tmp/cceJiy7O.s 			page 32


 580:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     {
 1006              		.loc 1 580 0
 1007 00ca 0246     		mov	r2, r0
 1008 00cc A0B9     		cbnz	r0, .L88
 585:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       MSC_Handle->unit[lun].error = MSC_ERROR;
 1009              		.loc 1 585 0
 1010 00ce 3421     		movs	r1, #52
 1011 00d0 01FB0451 		mla	r1, r1, r4, r5
 1012 00d4 0123     		movs	r3, #1
 1013 00d6 81F89030 		strb	r3, [r1, #144]
 586:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       
 1014              		.loc 1 586 0
 1015 00da 0223     		movs	r3, #2
 1016 00dc 81F89130 		strb	r3, [r1, #145]
 1017              	.LVL108:
 1018              	.L84:
 590:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     {
 1019              		.loc 1 590 0
 1020 00e0 022A     		cmp	r2, #2
 1021 00e2 9FD0     		beq	.L76
 594:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     {
 1022              		.loc 1 594 0
 1023 00e4 042A     		cmp	r2, #4
 1024 00e6 9DD1     		bne	.L76
 596:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****           error = USBH_FAIL;
 1025              		.loc 1 596 0
 1026 00e8 3423     		movs	r3, #52
 1027              	.LVL109:
 1028 00ea 03FB0454 		mla	r4, r3, r4, r5
 1029 00ee 0823     		movs	r3, #8
 1030 00f0 84F89030 		strb	r3, [r4, #144]
 1031              	.LVL110:
 597:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     }
 1032              		.loc 1 597 0
 1033 00f4 0223     		movs	r3, #2
 1034 00f6 95E7     		b	.L76
 1035              	.LVL111:
 1036              	.L88:
 526:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   USBH_StatusTypeDef scsi_status = USBH_BUSY ;  
 1037              		.loc 1 526 0
 1038 00f8 0123     		movs	r3, #1
 1039 00fa F1E7     		b	.L84
 1040              		.cfi_endproc
 1041              	.LFE71:
 1043              		.section	.text.USBH_MSC_IsReady,"ax",%progbits
 1044              		.align	1
 1045              		.global	USBH_MSC_IsReady
 1046              		.syntax unified
 1047              		.thumb
 1048              		.thumb_func
 1049              		.fpu softvfp
 1051              	USBH_MSC_IsReady:
 1052              	.LFB72:
 610:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** 
 611:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** /**
 612:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @brief  USBH_MSC_IsReady 
 613:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   *         The function check if the MSC function is ready
ARM GAS  /tmp/cceJiy7O.s 			page 33


 614:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @param  phost: Host handle
 615:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @retval USBH Status
 616:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   */
 617:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** uint8_t  USBH_MSC_IsReady (USBH_HandleTypeDef *phost)
 618:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** {
 1053              		.loc 1 618 0
 1054              		.cfi_startproc
 1055              		@ args = 0, pretend = 0, frame = 0
 1056              		@ frame_needed = 0, uses_anonymous_args = 0
 1057              		@ link register save eliminated.
 1058              	.LVL112:
 619:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     MSC_HandleTypeDef *MSC_Handle =  (MSC_HandleTypeDef *) phost->pActiveClass->pData;  
 1059              		.loc 1 619 0
 1060 0000 D0F87433 		ldr	r3, [r0, #884]
 1061 0004 DA69     		ldr	r2, [r3, #28]
 1062              	.LVL113:
 620:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     
 621:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   if(phost->gState == HOST_CLASS)
 1063              		.loc 1 621 0
 1064 0006 0378     		ldrb	r3, [r0]	@ zero_extendqisi2
 1065 0008 DBB2     		uxtb	r3, r3
 1066 000a 0A2B     		cmp	r3, #10
 1067 000c 01D0     		beq	.L101
 622:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   {
 623:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     return (MSC_Handle->state == MSC_IDLE);
 624:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   }
 625:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   else
 626:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   {
 627:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     return 0;
 1068              		.loc 1 627 0
 1069 000e 0020     		movs	r0, #0
 1070              	.LVL114:
 628:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   }
 629:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** }
 1071              		.loc 1 629 0
 1072 0010 7047     		bx	lr
 1073              	.LVL115:
 1074              	.L101:
 623:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   }
 1075              		.loc 1 623 0
 1076 0012 107B     		ldrb	r0, [r2, #12]	@ zero_extendqisi2
 1077              	.LVL116:
 1078 0014 0128     		cmp	r0, #1
 1079 0016 14BF     		ite	ne
 1080 0018 0020     		movne	r0, #0
 1081 001a 0120     		moveq	r0, #1
 1082 001c 7047     		bx	lr
 1083              		.cfi_endproc
 1084              	.LFE72:
 1086              		.section	.text.USBH_MSC_GetMaxLUN,"ax",%progbits
 1087              		.align	1
 1088              		.global	USBH_MSC_GetMaxLUN
 1089              		.syntax unified
 1090              		.thumb
 1091              		.thumb_func
 1092              		.fpu softvfp
 1094              	USBH_MSC_GetMaxLUN:
ARM GAS  /tmp/cceJiy7O.s 			page 34


 1095              	.LFB73:
 630:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** 
 631:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** /**
 632:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @brief  USBH_MSC_GetMaxLUN 
 633:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   *         The function return the Max LUN supported
 634:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @param  phost: Host handle
 635:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @retval logical Unit Number supported
 636:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   */
 637:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** int8_t  USBH_MSC_GetMaxLUN (USBH_HandleTypeDef *phost)
 638:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** {
 1096              		.loc 1 638 0
 1097              		.cfi_startproc
 1098              		@ args = 0, pretend = 0, frame = 0
 1099              		@ frame_needed = 0, uses_anonymous_args = 0
 1100              		@ link register save eliminated.
 1101              	.LVL117:
 639:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   MSC_HandleTypeDef *MSC_Handle =  (MSC_HandleTypeDef *) phost->pActiveClass->pData;    
 1102              		.loc 1 639 0
 1103 0000 D0F87433 		ldr	r3, [r0, #884]
 1104 0004 DA69     		ldr	r2, [r3, #28]
 1105              	.LVL118:
 640:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   
 641:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   if ((phost->gState == HOST_CLASS) && (MSC_Handle->state == MSC_IDLE))
 1106              		.loc 1 641 0
 1107 0006 0378     		ldrb	r3, [r0]	@ zero_extendqisi2
 1108 0008 DBB2     		uxtb	r3, r3
 1109 000a 0A2B     		cmp	r3, #10
 1110 000c 05D1     		bne	.L104
 1111              		.loc 1 641 0 is_stmt 0 discriminator 1
 1112 000e 137B     		ldrb	r3, [r2, #12]	@ zero_extendqisi2
 1113 0010 012B     		cmp	r3, #1
 1114 0012 05D1     		bne	.L105
 642:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   {
 643:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     return  MSC_Handle->max_lun;
 1115              		.loc 1 643 0 is_stmt 1
 1116 0014 92F90000 		ldrsb	r0, [r2]
 1117              	.LVL119:
 1118 0018 7047     		bx	lr
 1119              	.LVL120:
 1120              	.L104:
 644:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   }  
 645:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   return 0xFF;
 1121              		.loc 1 645 0
 1122 001a 4FF0FF30 		mov	r0, #-1
 1123              	.LVL121:
 1124 001e 7047     		bx	lr
 1125              	.LVL122:
 1126              	.L105:
 1127 0020 4FF0FF30 		mov	r0, #-1
 1128              	.LVL123:
 646:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** }
 1129              		.loc 1 646 0
 1130 0024 7047     		bx	lr
 1131              		.cfi_endproc
 1132              	.LFE73:
 1134              		.section	.text.USBH_MSC_UnitIsReady,"ax",%progbits
 1135              		.align	1
ARM GAS  /tmp/cceJiy7O.s 			page 35


 1136              		.global	USBH_MSC_UnitIsReady
 1137              		.syntax unified
 1138              		.thumb
 1139              		.thumb_func
 1140              		.fpu softvfp
 1142              	USBH_MSC_UnitIsReady:
 1143              	.LFB74:
 647:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** 
 648:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** /**
 649:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @brief  USBH_MSC_UnitIsReady 
 650:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   *         The function check whether a LUN is ready
 651:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @param  phost: Host handle
 652:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @param  lun: logical Unit Number
 653:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @retval Lun status (0: not ready / 1: ready)
 654:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   */
 655:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** uint8_t  USBH_MSC_UnitIsReady (USBH_HandleTypeDef *phost, uint8_t lun)
 656:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** {
 1144              		.loc 1 656 0
 1145              		.cfi_startproc
 1146              		@ args = 0, pretend = 0, frame = 0
 1147              		@ frame_needed = 0, uses_anonymous_args = 0
 1148              		@ link register save eliminated.
 1149              	.LVL124:
 657:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   MSC_HandleTypeDef *MSC_Handle =  (MSC_HandleTypeDef *) phost->pActiveClass->pData;  
 1150              		.loc 1 657 0
 1151 0000 D0F87433 		ldr	r3, [r0, #884]
 1152 0004 DA69     		ldr	r2, [r3, #28]
 1153              	.LVL125:
 658:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   
 659:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   if(phost->gState == HOST_CLASS)
 1154              		.loc 1 659 0
 1155 0006 0378     		ldrb	r3, [r0]	@ zero_extendqisi2
 1156 0008 DBB2     		uxtb	r3, r3
 1157 000a 0A2B     		cmp	r3, #10
 1158 000c 01D0     		beq	.L109
 660:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   {
 661:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     return (MSC_Handle->unit[lun].error == MSC_OK);
 662:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   }
 663:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   else
 664:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   {
 665:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     return 0;
 1159              		.loc 1 665 0
 1160 000e 0020     		movs	r0, #0
 1161              	.LVL126:
 666:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   }
 667:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** }
 1162              		.loc 1 667 0
 1163 0010 7047     		bx	lr
 1164              	.LVL127:
 1165              	.L109:
 661:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   }
 1166              		.loc 1 661 0
 1167 0012 3423     		movs	r3, #52
 1168 0014 03FB0121 		mla	r1, r3, r1, r2
 1169              	.LVL128:
 1170 0018 91F89100 		ldrb	r0, [r1, #145]	@ zero_extendqisi2
 1171              	.LVL129:
ARM GAS  /tmp/cceJiy7O.s 			page 36


 1172 001c B0FA80F0 		clz	r0, r0
 1173 0020 4009     		lsrs	r0, r0, #5
 1174 0022 7047     		bx	lr
 1175              		.cfi_endproc
 1176              	.LFE74:
 1178              		.section	.text.USBH_MSC_GetLUNInfo,"ax",%progbits
 1179              		.align	1
 1180              		.global	USBH_MSC_GetLUNInfo
 1181              		.syntax unified
 1182              		.thumb
 1183              		.thumb_func
 1184              		.fpu softvfp
 1186              	USBH_MSC_GetLUNInfo:
 1187              	.LFB75:
 668:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       
 669:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** /**
 670:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @brief  USBH_MSC_GetLUNInfo 
 671:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   *         The function return a LUN information
 672:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @param  phost: Host handle
 673:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @param  lun: logical Unit Number
 674:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @retval USBH Status
 675:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   */
 676:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** USBH_StatusTypeDef USBH_MSC_GetLUNInfo(USBH_HandleTypeDef *phost, uint8_t lun, MSC_LUNTypeDef *info
 677:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** {
 1188              		.loc 1 677 0
 1189              		.cfi_startproc
 1190              		@ args = 0, pretend = 0, frame = 0
 1191              		@ frame_needed = 0, uses_anonymous_args = 0
 1192              		@ link register save eliminated.
 1193              	.LVL130:
 678:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   MSC_HandleTypeDef *MSC_Handle =  (MSC_HandleTypeDef *) phost->pActiveClass->pData;    
 1194              		.loc 1 678 0
 1195 0000 D0F87433 		ldr	r3, [r0, #884]
 1196 0004 DB69     		ldr	r3, [r3, #28]
 1197              	.LVL131:
 679:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   if(phost->gState == HOST_CLASS)
 1198              		.loc 1 679 0
 1199 0006 0078     		ldrb	r0, [r0]	@ zero_extendqisi2
 1200              	.LVL132:
 1201 0008 C0B2     		uxtb	r0, r0
 1202 000a 0A28     		cmp	r0, #10
 1203 000c 01D0     		beq	.L118
 680:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   {
 681:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     USBH_memcpy(info,&MSC_Handle->unit[lun], sizeof(MSC_LUNTypeDef));
 682:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     return USBH_OK;
 683:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   }
 684:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   else
 685:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   {
 686:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     return USBH_FAIL;
 1204              		.loc 1 686 0
 1205 000e 0220     		movs	r0, #2
 687:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   }
 688:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** }
 1206              		.loc 1 688 0
 1207 0010 7047     		bx	lr
 1208              	.L118:
 677:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   MSC_HandleTypeDef *MSC_Handle =  (MSC_HandleTypeDef *) phost->pActiveClass->pData;    
ARM GAS  /tmp/cceJiy7O.s 			page 37


 1209              		.loc 1 677 0
 1210 0012 70B4     		push	{r4, r5, r6}
 1211              	.LCFI11:
 1212              		.cfi_def_cfa_offset 12
 1213              		.cfi_offset 4, -12
 1214              		.cfi_offset 5, -8
 1215              		.cfi_offset 6, -4
 681:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     return USBH_OK;
 1216              		.loc 1 681 0
 1217 0014 3420     		movs	r0, #52
 1218 0016 00FB01F1 		mul	r1, r0, r1
 1219              	.LVL133:
 1220 001a 9031     		adds	r1, r1, #144
 1221 001c 1944     		add	r1, r1, r3
 1222 001e 01F13003 		add	r3, r1, #48
 1223              	.LVL134:
 1224              	.L112:
 1225 0022 0E68     		ldr	r6, [r1]	@ unaligned
 1226 0024 4D68     		ldr	r5, [r1, #4]	@ unaligned
 1227 0026 8C68     		ldr	r4, [r1, #8]	@ unaligned
 1228 0028 C868     		ldr	r0, [r1, #12]	@ unaligned
 1229 002a 1660     		str	r6, [r2]	@ unaligned
 1230 002c 5560     		str	r5, [r2, #4]	@ unaligned
 1231 002e 9460     		str	r4, [r2, #8]	@ unaligned
 1232 0030 D060     		str	r0, [r2, #12]	@ unaligned
 1233 0032 1031     		adds	r1, r1, #16
 1234 0034 1032     		adds	r2, r2, #16
 1235 0036 9942     		cmp	r1, r3
 1236 0038 F3D1     		bne	.L112
 1237 003a 0B68     		ldr	r3, [r1]	@ unaligned
 1238 003c 1360     		str	r3, [r2]	@ unaligned
 682:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   }
 1239              		.loc 1 682 0
 1240 003e 0020     		movs	r0, #0
 1241              		.loc 1 688 0
 1242 0040 70BC     		pop	{r4, r5, r6}
 1243              	.LCFI12:
 1244              		.cfi_restore 6
 1245              		.cfi_restore 5
 1246              		.cfi_restore 4
 1247              		.cfi_def_cfa_offset 0
 1248 0042 7047     		bx	lr
 1249              		.cfi_endproc
 1250              	.LFE75:
 1252              		.section	.text.USBH_MSC_Read,"ax",%progbits
 1253              		.align	1
 1254              		.global	USBH_MSC_Read
 1255              		.syntax unified
 1256              		.thumb
 1257              		.thumb_func
 1258              		.fpu softvfp
 1260              	USBH_MSC_Read:
 1261              	.LFB76:
 689:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** 
 690:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** /**
 691:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @brief  USBH_MSC_Read 
 692:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   *         The function performs a Read operation 
ARM GAS  /tmp/cceJiy7O.s 			page 38


 693:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @param  phost: Host handle
 694:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @param  lun: logical Unit Number
 695:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @param  address: sector address
 696:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @param  pbuf: pointer to data
 697:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @param  length: number of sector to read
 698:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @retval USBH Status
 699:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   */
 700:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** USBH_StatusTypeDef USBH_MSC_Read(USBH_HandleTypeDef *phost,
 701:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****                                      uint8_t lun,
 702:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****                                      uint32_t address,
 703:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****                                      uint8_t *pbuf,
 704:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****                                      uint32_t length)
 705:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** {
 1262              		.loc 1 705 0
 1263              		.cfi_startproc
 1264              		@ args = 4, pretend = 0, frame = 0
 1265              		@ frame_needed = 0, uses_anonymous_args = 0
 1266              	.LVL135:
 1267 0000 F0B5     		push	{r4, r5, r6, r7, lr}
 1268              	.LCFI13:
 1269              		.cfi_def_cfa_offset 20
 1270              		.cfi_offset 4, -20
 1271              		.cfi_offset 5, -16
 1272              		.cfi_offset 6, -12
 1273              		.cfi_offset 7, -8
 1274              		.cfi_offset 14, -4
 1275 0002 83B0     		sub	sp, sp, #12
 1276              	.LCFI14:
 1277              		.cfi_def_cfa_offset 32
 706:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   uint32_t timeout;
 707:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   MSC_HandleTypeDef *MSC_Handle =  (MSC_HandleTypeDef *) phost->pActiveClass->pData;   
 1278              		.loc 1 707 0
 1279 0004 D0F87443 		ldr	r4, [r0, #884]
 1280 0008 E769     		ldr	r7, [r4, #28]
 1281              	.LVL136:
 708:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   
 709:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   if ((phost->device.is_connected == 0) || 
 1282              		.loc 1 709 0
 1283 000a 90F81E43 		ldrb	r4, [r0, #798]	@ zero_extendqisi2
 1284 000e 002C     		cmp	r4, #0
 1285 0010 3BD0     		beq	.L124
 710:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       (phost->gState != HOST_CLASS) || 
 1286              		.loc 1 710 0 discriminator 1
 1287 0012 0478     		ldrb	r4, [r0]	@ zero_extendqisi2
 1288 0014 E4B2     		uxtb	r4, r4
 709:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       (phost->gState != HOST_CLASS) || 
 1289              		.loc 1 709 0 discriminator 1
 1290 0016 0A2C     		cmp	r4, #10
 1291 0018 39D1     		bne	.L125
 711:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       (MSC_Handle->unit[lun].state != MSC_IDLE))
 1292              		.loc 1 711 0
 1293 001a 3424     		movs	r4, #52
 1294 001c 04FB0174 		mla	r4, r4, r1, r7
 1295 0020 94F89040 		ldrb	r4, [r4, #144]	@ zero_extendqisi2
 710:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       (phost->gState != HOST_CLASS) || 
 1296              		.loc 1 710 0
 1297 0024 012C     		cmp	r4, #1
ARM GAS  /tmp/cceJiy7O.s 			page 39


 1298 0026 01D0     		beq	.L128
 712:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   {
 713:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     return  USBH_FAIL;
 1299              		.loc 1 713 0
 1300 0028 0220     		movs	r0, #2
 1301              	.LVL137:
 1302 002a 31E0     		b	.L120
 1303              	.LVL138:
 1304              	.L128:
 1305 002c 0E46     		mov	r6, r1
 1306 002e 0446     		mov	r4, r0
 714:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   }
 715:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   MSC_Handle->state = MSC_READ;
 1307              		.loc 1 715 0
 1308 0030 0620     		movs	r0, #6
 1309              	.LVL139:
 1310 0032 3873     		strb	r0, [r7, #12]
 716:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   MSC_Handle->unit[lun].state = MSC_READ;
 1311              		.loc 1 716 0
 1312 0034 3421     		movs	r1, #52
 1313              	.LVL140:
 1314 0036 01FB0671 		mla	r1, r1, r6, r7
 1315 003a 81F89000 		strb	r0, [r1, #144]
 717:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   MSC_Handle->rw_lun = lun;
 1316              		.loc 1 717 0
 1317 003e A7F8FA60 		strh	r6, [r7, #250]	@ movhi
 718:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   USBH_MSC_SCSI_Read(phost,
 1318              		.loc 1 718 0
 1319 0042 0899     		ldr	r1, [sp, #32]
 1320 0044 0091     		str	r1, [sp]
 1321 0046 3146     		mov	r1, r6
 1322 0048 2046     		mov	r0, r4
 1323 004a FFF7FEFF 		bl	USBH_MSC_SCSI_Read
 1324              	.LVL141:
 719:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****                      lun,
 720:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****                      address,
 721:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****                      pbuf,
 722:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****                      length);
 723:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   
 724:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   timeout = phost->Timer;
 1325              		.loc 1 724 0
 1326 004e D4F8B853 		ldr	r5, [r4, #952]
 1327              	.LVL142:
 1328              	.L121:
 725:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   
 726:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   while (USBH_MSC_RdWrProcess(phost, lun) == USBH_BUSY)
 1329              		.loc 1 726 0
 1330 0052 3146     		mov	r1, r6
 1331 0054 2046     		mov	r0, r4
 1332 0056 FFF7FEFF 		bl	USBH_MSC_RdWrProcess
 1333              	.LVL143:
 1334 005a 0128     		cmp	r0, #1
 1335 005c 11D1     		bne	.L129
 727:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   {
 728:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     if(((phost->Timer - timeout) > (10000 * length)) || (phost->device.is_connected == 0))
 1336              		.loc 1 728 0
 1337 005e D4F8B823 		ldr	r2, [r4, #952]
ARM GAS  /tmp/cceJiy7O.s 			page 40


 1338 0062 521B     		subs	r2, r2, r5
 1339 0064 42F21073 		movw	r3, #10000
 1340 0068 0899     		ldr	r1, [sp, #32]
 1341 006a 03FB01F3 		mul	r3, r3, r1
 1342 006e 9A42     		cmp	r2, r3
 1343 0070 03D8     		bhi	.L122
 1344              		.loc 1 728 0 is_stmt 0 discriminator 1
 1345 0072 94F81E33 		ldrb	r3, [r4, #798]	@ zero_extendqisi2
 1346 0076 002B     		cmp	r3, #0
 1347 0078 EBD1     		bne	.L121
 1348              	.L122:
 729:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     {
 730:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       MSC_Handle->state = MSC_IDLE;
 1349              		.loc 1 730 0 is_stmt 1
 1350 007a 0123     		movs	r3, #1
 1351 007c 3B73     		strb	r3, [r7, #12]
 731:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       return USBH_FAIL;
 1352              		.loc 1 731 0
 1353 007e 0220     		movs	r0, #2
 1354 0080 06E0     		b	.L120
 1355              	.L129:
 732:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     }
 733:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   }
 734:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   MSC_Handle->state = MSC_IDLE;
 1356              		.loc 1 734 0
 1357 0082 0123     		movs	r3, #1
 1358 0084 3B73     		strb	r3, [r7, #12]
 735:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   return USBH_OK;
 1359              		.loc 1 735 0
 1360 0086 0020     		movs	r0, #0
 1361 0088 02E0     		b	.L120
 1362              	.LVL144:
 1363              	.L124:
 713:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   }
 1364              		.loc 1 713 0
 1365 008a 0220     		movs	r0, #2
 1366              	.LVL145:
 1367 008c 00E0     		b	.L120
 1368              	.LVL146:
 1369              	.L125:
 1370 008e 0220     		movs	r0, #2
 1371              	.LVL147:
 1372              	.L120:
 736:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** }
 1373              		.loc 1 736 0
 1374 0090 03B0     		add	sp, sp, #12
 1375              	.LCFI15:
 1376              		.cfi_def_cfa_offset 20
 1377              		@ sp needed
 1378 0092 F0BD     		pop	{r4, r5, r6, r7, pc}
 1379              		.cfi_endproc
 1380              	.LFE76:
 1382              		.section	.text.USBH_MSC_Write,"ax",%progbits
 1383              		.align	1
 1384              		.global	USBH_MSC_Write
 1385              		.syntax unified
 1386              		.thumb
ARM GAS  /tmp/cceJiy7O.s 			page 41


 1387              		.thumb_func
 1388              		.fpu softvfp
 1390              	USBH_MSC_Write:
 1391              	.LFB77:
 737:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** 
 738:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** /**
 739:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @brief  USBH_MSC_Write 
 740:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   *         The function performs a Write operation 
 741:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @param  phost: Host handle
 742:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @param  lun: logical Unit Number
 743:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @param  address: sector address
 744:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @param  pbuf: pointer to data
 745:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @param  length: number of sector to write
 746:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   * @retval USBH Status
 747:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   */
 748:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** USBH_StatusTypeDef USBH_MSC_Write(USBH_HandleTypeDef *phost,
 749:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****                                      uint8_t lun,
 750:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****                                      uint32_t address,
 751:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****                                      uint8_t *pbuf,
 752:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****                                      uint32_t length)
 753:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** {
 1392              		.loc 1 753 0
 1393              		.cfi_startproc
 1394              		@ args = 4, pretend = 0, frame = 0
 1395              		@ frame_needed = 0, uses_anonymous_args = 0
 1396              	.LVL148:
 1397 0000 F0B5     		push	{r4, r5, r6, r7, lr}
 1398              	.LCFI16:
 1399              		.cfi_def_cfa_offset 20
 1400              		.cfi_offset 4, -20
 1401              		.cfi_offset 5, -16
 1402              		.cfi_offset 6, -12
 1403              		.cfi_offset 7, -8
 1404              		.cfi_offset 14, -4
 1405 0002 83B0     		sub	sp, sp, #12
 1406              	.LCFI17:
 1407              		.cfi_def_cfa_offset 32
 754:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   uint32_t timeout;
 755:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   MSC_HandleTypeDef *MSC_Handle =  (MSC_HandleTypeDef *) phost->pActiveClass->pData;   
 1408              		.loc 1 755 0
 1409 0004 D0F87443 		ldr	r4, [r0, #884]
 1410 0008 E769     		ldr	r7, [r4, #28]
 1411              	.LVL149:
 756:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   
 757:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   if ((phost->device.is_connected == 0) || 
 1412              		.loc 1 757 0
 1413 000a 90F81E43 		ldrb	r4, [r0, #798]	@ zero_extendqisi2
 1414 000e 002C     		cmp	r4, #0
 1415 0010 3BD0     		beq	.L135
 758:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       (phost->gState != HOST_CLASS) || 
 1416              		.loc 1 758 0 discriminator 1
 1417 0012 0478     		ldrb	r4, [r0]	@ zero_extendqisi2
 1418 0014 E4B2     		uxtb	r4, r4
 757:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       (phost->gState != HOST_CLASS) || 
 1419              		.loc 1 757 0 discriminator 1
 1420 0016 0A2C     		cmp	r4, #10
 1421 0018 39D1     		bne	.L136
ARM GAS  /tmp/cceJiy7O.s 			page 42


 759:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       (MSC_Handle->unit[lun].state != MSC_IDLE))
 1422              		.loc 1 759 0
 1423 001a 3424     		movs	r4, #52
 1424 001c 04FB0174 		mla	r4, r4, r1, r7
 1425 0020 94F89040 		ldrb	r4, [r4, #144]	@ zero_extendqisi2
 758:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       (phost->gState != HOST_CLASS) || 
 1426              		.loc 1 758 0
 1427 0024 012C     		cmp	r4, #1
 1428 0026 01D0     		beq	.L139
 760:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   {
 761:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     return  USBH_FAIL;
 1429              		.loc 1 761 0
 1430 0028 0220     		movs	r0, #2
 1431              	.LVL150:
 1432 002a 31E0     		b	.L131
 1433              	.LVL151:
 1434              	.L139:
 1435 002c 0E46     		mov	r6, r1
 1436 002e 0446     		mov	r4, r0
 762:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   }
 763:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   MSC_Handle->state = MSC_WRITE;
 1437              		.loc 1 763 0
 1438 0030 0720     		movs	r0, #7
 1439              	.LVL152:
 1440 0032 3873     		strb	r0, [r7, #12]
 764:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   MSC_Handle->unit[lun].state = MSC_WRITE;
 1441              		.loc 1 764 0
 1442 0034 3421     		movs	r1, #52
 1443              	.LVL153:
 1444 0036 01FB0671 		mla	r1, r1, r6, r7
 1445 003a 81F89000 		strb	r0, [r1, #144]
 765:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   MSC_Handle->rw_lun = lun;
 1446              		.loc 1 765 0
 1447 003e A7F8FA60 		strh	r6, [r7, #250]	@ movhi
 766:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   USBH_MSC_SCSI_Write(phost,
 1448              		.loc 1 766 0
 1449 0042 0899     		ldr	r1, [sp, #32]
 1450 0044 0091     		str	r1, [sp]
 1451 0046 3146     		mov	r1, r6
 1452 0048 2046     		mov	r0, r4
 1453 004a FFF7FEFF 		bl	USBH_MSC_SCSI_Write
 1454              	.LVL154:
 767:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****                      lun,
 768:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****                      address,
 769:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****                      pbuf,
 770:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****                      length);
 771:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   
 772:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   timeout = phost->Timer;
 1455              		.loc 1 772 0
 1456 004e D4F8B853 		ldr	r5, [r4, #952]
 1457              	.LVL155:
 1458              	.L132:
 773:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   while (USBH_MSC_RdWrProcess(phost, lun) == USBH_BUSY)
 1459              		.loc 1 773 0
 1460 0052 3146     		mov	r1, r6
 1461 0054 2046     		mov	r0, r4
 1462 0056 FFF7FEFF 		bl	USBH_MSC_RdWrProcess
ARM GAS  /tmp/cceJiy7O.s 			page 43


 1463              	.LVL156:
 1464 005a 0128     		cmp	r0, #1
 1465 005c 11D1     		bne	.L140
 774:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   {
 775:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     if(((phost->Timer - timeout) >  (10000 * length)) || (phost->device.is_connected == 0))
 1466              		.loc 1 775 0
 1467 005e D4F8B823 		ldr	r2, [r4, #952]
 1468 0062 521B     		subs	r2, r2, r5
 1469 0064 42F21073 		movw	r3, #10000
 1470 0068 0899     		ldr	r1, [sp, #32]
 1471 006a 03FB01F3 		mul	r3, r3, r1
 1472 006e 9A42     		cmp	r2, r3
 1473 0070 03D8     		bhi	.L133
 1474              		.loc 1 775 0 is_stmt 0 discriminator 1
 1475 0072 94F81E33 		ldrb	r3, [r4, #798]	@ zero_extendqisi2
 1476 0076 002B     		cmp	r3, #0
 1477 0078 EBD1     		bne	.L132
 1478              	.L133:
 776:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     {
 777:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       MSC_Handle->state = MSC_IDLE;
 1479              		.loc 1 777 0 is_stmt 1
 1480 007a 0123     		movs	r3, #1
 1481 007c 3B73     		strb	r3, [r7, #12]
 778:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****       return USBH_FAIL;
 1482              		.loc 1 778 0
 1483 007e 0220     		movs	r0, #2
 1484 0080 06E0     		b	.L131
 1485              	.L140:
 779:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****     }
 780:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   }
 781:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   MSC_Handle->state = MSC_IDLE;
 1486              		.loc 1 781 0
 1487 0082 0123     		movs	r3, #1
 1488 0084 3B73     		strb	r3, [r7, #12]
 782:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   return USBH_OK;
 1489              		.loc 1 782 0
 1490 0086 0020     		movs	r0, #0
 1491 0088 02E0     		b	.L131
 1492              	.LVL157:
 1493              	.L135:
 761:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c ****   }
 1494              		.loc 1 761 0
 1495 008a 0220     		movs	r0, #2
 1496              	.LVL158:
 1497 008c 00E0     		b	.L131
 1498              	.LVL159:
 1499              	.L136:
 1500 008e 0220     		movs	r0, #2
 1501              	.LVL160:
 1502              	.L131:
 783:Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Src/usbh_msc.c **** }
 1503              		.loc 1 783 0
 1504 0090 03B0     		add	sp, sp, #12
 1505              	.LCFI18:
 1506              		.cfi_def_cfa_offset 20
 1507              		@ sp needed
 1508 0092 F0BD     		pop	{r4, r5, r6, r7, pc}
ARM GAS  /tmp/cceJiy7O.s 			page 44


 1509              		.cfi_endproc
 1510              	.LFE77:
 1512              		.global	USBH_msc
 1513              		.section	.data.USBH_msc,"aw",%progbits
 1514              		.align	2
 1517              	USBH_msc:
 1518 0000 00000000 		.word	.LC0
 1519 0004 08       		.byte	8
 1520 0005 000000   		.space	3
 1521 0008 00000000 		.word	USBH_MSC_InterfaceInit
 1522 000c 00000000 		.word	USBH_MSC_InterfaceDeInit
 1523 0010 00000000 		.word	USBH_MSC_ClassRequest
 1524 0014 00000000 		.word	USBH_MSC_Process
 1525 0018 00000000 		.word	USBH_MSC_SOFProcess
 1526 001c 00000000 		.word	0
 1527              		.section	.rodata.str1.4,"aMS",%progbits,1
 1528              		.align	2
 1529              	.LC0:
 1530 0000 4D534300 		.ascii	"MSC\000"
 1531              		.text
 1532              	.Letext0:
 1533              		.file 2 "/usr/arm-none-eabi/include/machine/_default_types.h"
 1534              		.file 3 "/usr/arm-none-eabi/include/sys/lock.h"
 1535              		.file 4 "/usr/arm-none-eabi/include/sys/_types.h"
 1536              		.file 5 "/usr/lib/gcc/arm-none-eabi/7.3.1/include/stddef.h"
 1537              		.file 6 "/usr/arm-none-eabi/include/sys/reent.h"
 1538              		.file 7 "/usr/arm-none-eabi/include/sys/_stdint.h"
 1539              		.file 8 "/usr/arm-none-eabi/include/stdlib.h"
 1540              		.file 9 "Drivers/CMSIS/Include/core_cm3.h"
 1541              		.file 10 "Drivers/CMSIS/Device/ST/STM32F1xx/Include/system_stm32f1xx.h"
 1542              		.file 11 "Drivers/STM32F1xx_HAL_Driver/Inc/stm32f1xx_hal.h"
 1543              		.file 12 "Middlewares/ST/STM32_USB_Host_Library/Core/Inc/usbh_def.h"
 1544              		.file 13 "Middlewares/ST/STM32_USB_Host_Library/Core/Inc/usbh_ctlreq.h"
 1545              		.file 14 "Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Inc/usbh_msc_bot.h"
 1546              		.file 15 "Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Inc/usbh_msc_scsi.h"
 1547              		.file 16 "Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Inc/usbh_msc.h"
 1548              		.file 17 "Middlewares/ST/STM32_USB_Host_Library/Core/Inc/usbh_pipes.h"
 1549              		.file 18 "Middlewares/ST/STM32_USB_Host_Library/Core/Inc/usbh_core.h"
 1550              		.file 19 "<built-in>"
ARM GAS  /tmp/cceJiy7O.s 			page 45


DEFINED SYMBOLS
                            *ABS*:0000000000000000 usbh_msc.c
     /tmp/cceJiy7O.s:16     .text.USBH_MSC_SOFProcess:0000000000000000 $t
     /tmp/cceJiy7O.s:22     .text.USBH_MSC_SOFProcess:0000000000000000 USBH_MSC_SOFProcess
     /tmp/cceJiy7O.s:39     .text.USBH_MSC_Process:0000000000000000 $t
     /tmp/cceJiy7O.s:45     .text.USBH_MSC_Process:0000000000000000 USBH_MSC_Process
     /tmp/cceJiy7O.s:109    .text.USBH_MSC_Process:0000000000000052 $d
     /tmp/cceJiy7O.s:118    .text.USBH_MSC_Process:0000000000000064 $t
     /tmp/cceJiy7O.s:465    .text.USBH_MSC_ClassRequest:0000000000000000 $t
     /tmp/cceJiy7O.s:471    .text.USBH_MSC_ClassRequest:0000000000000000 USBH_MSC_ClassRequest
     /tmp/cceJiy7O.s:572    .text.USBH_MSC_InterfaceDeInit:0000000000000000 $t
     /tmp/cceJiy7O.s:578    .text.USBH_MSC_InterfaceDeInit:0000000000000000 USBH_MSC_InterfaceDeInit
     /tmp/cceJiy7O.s:653    .text.USBH_MSC_InterfaceInit:0000000000000000 $t
     /tmp/cceJiy7O.s:659    .text.USBH_MSC_InterfaceInit:0000000000000000 USBH_MSC_InterfaceInit
     /tmp/cceJiy7O.s:849    .text.USBH_MSC_RdWrProcess:0000000000000000 $t
     /tmp/cceJiy7O.s:855    .text.USBH_MSC_RdWrProcess:0000000000000000 USBH_MSC_RdWrProcess
     /tmp/cceJiy7O.s:1044   .text.USBH_MSC_IsReady:0000000000000000 $t
     /tmp/cceJiy7O.s:1051   .text.USBH_MSC_IsReady:0000000000000000 USBH_MSC_IsReady
     /tmp/cceJiy7O.s:1087   .text.USBH_MSC_GetMaxLUN:0000000000000000 $t
     /tmp/cceJiy7O.s:1094   .text.USBH_MSC_GetMaxLUN:0000000000000000 USBH_MSC_GetMaxLUN
     /tmp/cceJiy7O.s:1135   .text.USBH_MSC_UnitIsReady:0000000000000000 $t
     /tmp/cceJiy7O.s:1142   .text.USBH_MSC_UnitIsReady:0000000000000000 USBH_MSC_UnitIsReady
     /tmp/cceJiy7O.s:1179   .text.USBH_MSC_GetLUNInfo:0000000000000000 $t
     /tmp/cceJiy7O.s:1186   .text.USBH_MSC_GetLUNInfo:0000000000000000 USBH_MSC_GetLUNInfo
     /tmp/cceJiy7O.s:1253   .text.USBH_MSC_Read:0000000000000000 $t
     /tmp/cceJiy7O.s:1260   .text.USBH_MSC_Read:0000000000000000 USBH_MSC_Read
     /tmp/cceJiy7O.s:1383   .text.USBH_MSC_Write:0000000000000000 $t
     /tmp/cceJiy7O.s:1390   .text.USBH_MSC_Write:0000000000000000 USBH_MSC_Write
     /tmp/cceJiy7O.s:1517   .data.USBH_msc:0000000000000000 USBH_msc
     /tmp/cceJiy7O.s:1514   .data.USBH_msc:0000000000000000 $d
     /tmp/cceJiy7O.s:1528   .rodata.str1.4:0000000000000000 $d

UNDEFINED SYMBOLS
USBH_MSC_SCSI_Inquiry
USBH_MSC_SCSI_TestUnitReady
USBH_MSC_SCSI_ReadCapacity
USBH_MSC_SCSI_RequestSense
USBH_MSC_BOT_REQ_GetMaxLUN
USBH_ClrFeature
free
USBH_ClosePipe
USBH_FreePipe
USBH_FindInterface
USBH_SelectInterface
malloc
USBH_AllocPipe
USBH_MSC_BOT_Init
memset
USBH_OpenPipe
USBH_LL_SetToggle
USBH_MSC_SCSI_Read
USBH_MSC_SCSI_Write
